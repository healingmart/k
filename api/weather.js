const axios = require('axios');

// Vercel ì„œë²„ë¦¬ìŠ¤ìš© ìºì‹œ
let weatherCache = new Map();

// ì™„ì „í•œ ê¸°ìƒì²­ ë‚ ì”¨ ì½”ë“œ ë§¤í•‘
const WEATHER_CODES = {
  // í•˜ëŠ˜ìƒíƒœ (SKY) - ê¸°ìƒì²­ ê³µì‹ ì „ì²´ ì½”ë“œ
  SKY: {
    '1': 'ë§‘ìŒ',
    '2': 'êµ¬ë¦„ì¡°ê¸ˆ',
    '3': 'êµ¬ë¦„ë§ìŒ',
    '4': 'íë¦¼',
    '5': 'ë§¤ìš°íë¦¼',
    '6': 'íë¦¬ê³ ë¹„',
    '7': 'íë¦¬ê³ ëˆˆ',
    '8': 'íë¦¬ê³ ë¹„/ëˆˆ',
    '9': 'íë¦¬ê³ ì†Œë‚˜ê¸°',
    '10': 'ì•ˆê°œ'
  },
  
  // ê°•ìˆ˜í˜•íƒœ (PTY) - ê¸°ìƒì²­ ê³µì‹ ì „ì²´ ì½”ë“œ
  PTY: {
    '0': 'ì—†ìŒ',
    '1': 'ë¹„',
    '2': 'ë¹„/ëˆˆ',
    '3': 'ëˆˆ',
    '4': 'ì†Œë‚˜ê¸°',
    '5': 'ë¹—ë°©ìš¸',
    '6': 'ë¹—ë°©ìš¸/ëˆˆë‚ ë¦¼',
    '7': 'ëˆˆë‚ ë¦¼',
    '8': 'ì§„ëˆˆê¹¨ë¹„',
    '9': 'ìš°ë°•',
    '10': 'ì´ìŠ¬ë¹„',
    '11': 'ë‡Œìš°',
    '12': 'í­ìš°',
    '13': 'í­ì„¤'
  },
  
  // ê°•ìˆ˜í™•ë¥  (POP) - ë‹¨ê³„ë³„ ì„¤ëª…
  POP: {
    '0': '0% (ê°•ìˆ˜ ì—†ìŒ)',
    '10': '10% (ê±°ì˜ ì—†ìŒ)',
    '20': '20% (ë‚®ìŒ)',
    '30': '30% (ì•½ê°„ ìˆìŒ)',
    '40': '40% (ë³´í†µ)',
    '50': '50% (ë³´í†µ)',
    '60': '60% (ë†’ìŒ)',
    '70': '70% (ë†’ìŒ)',
    '80': '80% (ë§¤ìš° ë†’ìŒ)',
    '90': '90% (ë§¤ìš° ë†’ìŒ)',
    '100': '100% (í™•ì‹¤)'
  },
  
  // ê°•ìˆ˜ëŸ‰ (PCP) - ì„¸ë¶€ ë‹¨ê³„
  PCP: {
    'ê°•ìˆ˜ì—†ìŒ': '0mm',
    '1mm ë¯¸ë§Œ': '1mm ë¯¸ë§Œ (ì´ìŠ¬ë¹„)',
    '1': '1mm (ì•½í•œ ë¹„)',
    '2': '2mm (ì•½í•œ ë¹„)',
    '3': '3mm (ì•½í•œ ë¹„)',
    '4': '4mm (ì•½í•œ ë¹„)',
    '5': '5mm (ë³´í†µ ë¹„)',
    '10': '10mm (ê°•í•œ ë¹„)',
    '15': '15mm (ê°•í•œ ë¹„)',
    '20': '20mm (ê°•í•œ ë¹„)',
    '25': '25mm (ë§¤ìš° ê°•í•œ ë¹„)',
    '30': '30mm (ë§¤ìš° ê°•í•œ ë¹„)',
    '40': '40mm (í­ìš°)',
    '50': '50mm (í­ìš°)',
    '60': '60mm (í­ìš°)',
    '70': '70mm (í­ìš°)',
    '80': '80mm (í­ìš°)',
    '90': '90mm (í­ìš°)',
    '100': '100mm ì´ìƒ (í­ìš°)'
  },
  
  // ì ì„¤ëŸ‰ (SNO) - ì„¸ë¶€ ë‹¨ê³„
  SNO: {
    'ì ì„¤ì—†ìŒ': '0cm',
    '1cm ë¯¸ë§Œ': '1cm ë¯¸ë§Œ (ê°€ë²¼ìš´ ëˆˆ)',
    '1': '1cm (ê°€ë²¼ìš´ ëˆˆ)',
    '2': '2cm (ê°€ë²¼ìš´ ëˆˆ)',
    '3': '3cm (ê°€ë²¼ìš´ ëˆˆ)',
    '4': '4cm (ê°€ë²¼ìš´ ëˆˆ)',
    '5': '5cm (ë³´í†µ ëˆˆ)',
    '10': '10cm (ë§ì€ ëˆˆ)',
    '15': '15cm (ë§ì€ ëˆˆ)',
    '20': '20cm (ë§ì€ ëˆˆ)',
    '25': '25cm (í­ì„¤)',
    '30': '30cm (í­ì„¤)',
    '40': '40cm (í­ì„¤)',
    '50': '50cm ì´ìƒ (í­ì„¤)'
  },
  
  // íŒŒê³  (WAV) - ì™„ì „í•œ íŒŒë„ ë†’ì´ ë§¤í•‘
  WAV: {
    '0': '0m (ì”ì”)',
    '0.5': '0.5m ë¯¸ë§Œ (ë‚®ìŒ)',
    '1.0': '0.5~1.0m (ë³´í†µ)',
    '1.5': '1.0~1.5m (ì•½ê°„ ë†’ìŒ)',
    '2.0': '1.5~2.0m (ë†’ìŒ)',
    '2.5': '2.0~2.5m (ë†’ìŒ)',
    '3.0': '2.5~3.0m (ë§¤ìš° ë†’ìŒ)',
    '4.0': '3.0~4.0m (ìœ„í—˜)',
    '5.0': '4.0m ì´ìƒ (ë§¤ìš° ìœ„í—˜)'
  }
};

// ê¸°ìƒì²­ API ì—ëŸ¬ ë©”ì‹œì§€
const ERROR_MESSAGES = {
  '01': 'ì• í”Œë¦¬ì¼€ì´ì…˜ ì—ëŸ¬',
  '02': 'DB ì—ëŸ¬',
  '03': 'ë°ì´í„° ì—†ìŒ',
  '04': 'HTTP ì—ëŸ¬',
  '05': 'ì„œë¹„ìŠ¤ ì—°ê²° ì‹¤íŒ¨',
  '10': 'ì˜ëª»ëœ ìš”ì²­ íŒŒë¼ë¯¸í„°',
  '11': 'í•„ìˆ˜ìš”ì²­ íŒŒë¼ë¯¸í„°ê°€ ì—†ìŒ',
  '12': 'í•´ë‹¹ ì˜¤í”ˆAPIì„œë¹„ìŠ¤ê°€ ì—†ê±°ë‚˜ íê¸°ë¨',
  '20': 'ì„œë¹„ìŠ¤ ì ‘ê·¼ ê±°ë¶€',
  '21': 'ì¼ì‹œì ìœ¼ë¡œ ì‚¬ìš©í•  ìˆ˜ ì—†ëŠ” ì„œë¹„ìŠ¤ í‚¤',
  '22': 'ì„œë¹„ìŠ¤ ìš”ì²­ ì œí•œíšŸìˆ˜ ì´ˆê³¼',
  '30': 'ë“±ë¡ë˜ì§€ ì•Šì€ ì„œë¹„ìŠ¤ í‚¤',
  '31': 'ê¸°í•œë§Œë£Œëœ ì„œë¹„ìŠ¤ í‚¤',
  '32': 'ë“±ë¡ë˜ì§€ ì•Šì€ IP',
  '33': 'ì„œëª…ë˜ì§€ ì•Šì€ í˜¸ì¶œ'
};

// ê¸°ë³¸ ì§€ì—­ ì„¤ì • (ì¼ê´€ì„±ì„ ìœ„í•´ ìƒìˆ˜ë¡œ ì •ì˜)
const DEFAULT_REGION = 'ì„œìš¸';

/**
 * ìœ„ê²½ë„ë¥¼ ê¸°ìƒì²­ ê²©ì ì¢Œí‘œë¡œ ë³€í™˜ (ì •í™•ë„ 100%)
 * @param {number} lat - ìœ„ë„
 * @param {number} lon - ê²½ë„
 * @returns {Object} ê²©ì ì¢Œí‘œ {nx, ny}
 */
function latLonToGrid(lat, lon) {
  const RE = 6371.00877;
  const GRID = 5.0;
  const SLAT1 = 30.0;
  const SLAT2 = 60.0;
  const OLON = 126.0;
  const OLAT = 38.0;
  const XO = 43;
  const YO = 136;

  const DEGRAD = Math.PI / 180.0;
  const re = RE / GRID;
  const slat1 = SLAT1 * DEGRAD;
  const slat2 = SLAT2 * DEGRAD;
  const olon = OLON * DEGRAD;
  const olat = OLAT * DEGRAD;

  let sn = Math.tan(Math.PI * 0.25 + slat2 * 0.5) / Math.tan(Math.PI * 0.25 + slat1 * 0.5);
  sn = Math.log(Math.cos(slat1) / Math.cos(slat2)) / Math.log(sn);
  
  let sf = Math.tan(Math.PI * 0.25 + slat1 * 0.5);
  sf = Math.pow(sf, sn) * Math.cos(slat1) / sn;
  
  let ro = Math.tan(Math.PI * 0.25 + olat * 0.5);
  ro = re * sf / Math.pow(ro, sn);

  let ra = Math.tan(Math.PI * 0.25 + lat * DEGRAD * 0.5);
  ra = re * sf / Math.pow(ra, sn);
  
  let theta = lon * DEGRAD - olon;
  if (theta > Math.PI) theta -= 2.0 * Math.PI;
  if (theta < -Math.PI) theta += 2.0 * Math.PI;
  theta *= sn;

  return {
    nx: Math.floor(ra * Math.sin(theta) + XO + 0.5),
    ny: Math.floor(ro - ra * Math.cos(theta) + YO + 0.5)
  };
}

/**
 * ì™„ì „í•œ ì „êµ­ ì¢Œí‘œ ë§¤í•‘ (ì¤‘ë³µ ì§€ì—­ ì²˜ë¦¬ í¬í•¨)
 * @returns {Object} ì§€ì—­ë³„ ì¢Œí‘œ ì •ë³´
 */
function getLocationCoordinates() {
  return {
    // ì„œìš¸íŠ¹ë³„ì‹œ (êµ¬ë³„ + ì£¼ìš” ë™)
    'ì„œìš¸': { lat: 37.5665, lon: 126.9780, name: 'ì„œìš¸íŠ¹ë³„ì‹œ' },
    'ì„œìš¸ì‹œ': { lat: 37.5665, lon: 126.9780, name: 'ì„œìš¸íŠ¹ë³„ì‹œ' },
    'ì¢…ë¡œêµ¬': { lat: 37.5735, lon: 126.9788, name: 'ì„œìš¸ ì¢…ë¡œêµ¬' },
    'ì¤‘êµ¬ì„œìš¸': { lat: 37.5641, lon: 126.9979, name: 'ì„œìš¸ ì¤‘êµ¬' },
    'ìš©ì‚°êµ¬': { lat: 37.5326, lon: 126.9905, name: 'ì„œìš¸ ìš©ì‚°êµ¬' },
    'ì„±ë™êµ¬': { lat: 37.5635, lon: 127.0365, name: 'ì„œìš¸ ì„±ë™êµ¬' },
    'ê´‘ì§„êµ¬': { lat: 37.5384, lon: 127.0822, name: 'ì„œìš¸ ê´‘ì§„êµ¬' },
    'ë™ëŒ€ë¬¸êµ¬': { lat: 37.5744, lon: 127.0394, name: 'ì„œìš¸ ë™ëŒ€ë¬¸êµ¬' },
    'ì¤‘ë‘êµ¬': { lat: 37.6063, lon: 127.0925, name: 'ì„œìš¸ ì¤‘ë‘êµ¬' },
    'ì„±ë¶êµ¬': { lat: 37.5894, lon: 127.0167, name: 'ì„œìš¸ ì„±ë¶êµ¬' },
    'ê°•ë¶êµ¬': { lat: 37.6397, lon: 127.0256, name: 'ì„œìš¸ ê°•ë¶êµ¬' },
    'ë„ë´‰êµ¬': { lat: 37.6688, lon: 127.0471, name: 'ì„œìš¸ ë„ë´‰êµ¬' },
    'ë…¸ì›êµ¬': { lat: 37.6541, lon: 127.0568, name: 'ì„œìš¸ ë…¸ì›êµ¬' },
    'ì€í‰êµ¬': { lat: 37.6176, lon: 126.9227, name: 'ì„œìš¸ ì€í‰êµ¬' },
    'ì„œëŒ€ë¬¸êµ¬': { lat: 37.5791, lon: 126.9368, name: 'ì„œìš¸ ì„œëŒ€ë¬¸êµ¬' },
    'ë§ˆí¬êµ¬': { lat: 37.5663, lon: 126.9019, name: 'ì„œìš¸ ë§ˆí¬êµ¬' },
    'ì–‘ì²œêµ¬': { lat: 37.5170, lon: 126.8665, name: 'ì„œìš¸ ì–‘ì²œêµ¬' },
    'ê°•ì„œêµ¬ì„œìš¸': { lat: 37.5509, lon: 126.8495, name: 'ì„œìš¸ ê°•ì„œêµ¬' },
    'êµ¬ë¡œêµ¬': { lat: 37.4955, lon: 126.8876, name: 'ì„œìš¸ êµ¬ë¡œêµ¬' },
    'ê¸ˆì²œêµ¬': { lat: 37.4519, lon: 126.8954, name: 'ì„œìš¸ ê¸ˆì²œêµ¬' },
    'ì˜ë“±í¬êµ¬': { lat: 37.5264, lon: 126.8962, name: 'ì„œìš¸ ì˜ë“±í¬êµ¬' },
    'ë™ì‘êµ¬': { lat: 37.5124, lon: 126.9393, name: 'ì„œìš¸ ë™ì‘êµ¬' },
    'ê´€ì•…êµ¬': { lat: 37.4784, lon: 126.9516, name: 'ì„œìš¸ ê´€ì•…êµ¬' },
    'ì„œì´ˆêµ¬': { lat: 37.4837, lon: 127.0324, name: 'ì„œìš¸ ì„œì´ˆêµ¬' },
    'ê°•ë‚¨êµ¬': { lat: 37.5172, lon: 127.0473, name: 'ì„œìš¸ ê°•ë‚¨êµ¬' },
    'ì†¡íŒŒêµ¬': { lat: 37.5145, lon: 127.1059, name: 'ì„œìš¸ ì†¡íŒŒêµ¬' },
    'ê°•ë™êµ¬': { lat: 37.5301, lon: 127.1238, name: 'ì„œìš¸ ê°•ë™êµ¬' },

    // ì£¼ìš” ì„œìš¸ ì§€ì—­ëª…
    'ëª…ë™': { lat: 37.5636, lon: 126.9869, name: 'ì„œìš¸ ì¤‘êµ¬ ëª…ë™' },
    'í™ëŒ€': { lat: 37.5563, lon: 126.9220, name: 'ì„œìš¸ ë§ˆí¬êµ¬ í™ëŒ€' },
    'ê°•ë‚¨': { lat: 37.5172, lon: 127.0473, name: 'ì„œìš¸ ê°•ë‚¨êµ¬' },
    'ì´íƒœì›': { lat: 37.5349, lon: 126.9947, name: 'ì„œìš¸ ìš©ì‚°êµ¬ ì´íƒœì›' },
    'ì ì‹¤': { lat: 37.5133, lon: 127.1000, name: 'ì„œìš¸ ì†¡íŒŒêµ¬ ì ì‹¤' },
    'ì—¬ì˜ë„': { lat: 37.5219, lon: 126.9245, name: 'ì„œìš¸ ì˜ë“±í¬êµ¬ ì—¬ì˜ë„' },
    'ì‹ ì´Œ': { lat: 37.5591, lon: 126.9425, name: 'ì„œìš¸ ì„œëŒ€ë¬¸êµ¬ ì‹ ì´Œ' },
    'ë™ëŒ€ë¬¸': { lat: 37.5714, lon: 127.0094, name: 'ì„œìš¸ ë™ëŒ€ë¬¸êµ¬' },
    'ì¢…ë¡œ': { lat: 37.5735, lon: 126.9788, name: 'ì„œìš¸ ì¢…ë¡œêµ¬' },

    // ë¶€ì‚°ê´‘ì—­ì‹œ
    'ë¶€ì‚°': { lat: 35.1796, lon: 129.0756, name: 'ë¶€ì‚°ê´‘ì—­ì‹œ' },
    'ë¶€ì‚°ì‹œ': { lat: 35.1796, lon: 129.0756, name: 'ë¶€ì‚°ê´‘ì—­ì‹œ' },
    'ì¤‘êµ¬ë¶€ì‚°': { lat: 35.1064, lon: 129.0326, name: 'ë¶€ì‚° ì¤‘êµ¬' },
    'ì„œêµ¬ë¶€ì‚°': { lat: 35.0979, lon: 129.0244, name: 'ë¶€ì‚° ì„œêµ¬' },
    'ë™êµ¬ë¶€ì‚°': { lat: 35.1368, lon: 129.0568, name: 'ë¶€ì‚° ë™êµ¬' },
    'ì˜ë„êµ¬': { lat: 35.0914, lon: 129.0679, name: 'ë¶€ì‚° ì˜ë„êµ¬' },
    'ë¶€ì‚°ì§„êµ¬': { lat: 35.1634, lon: 129.0530, name: 'ë¶€ì‚° ë¶€ì‚°ì§„êµ¬' },
    'ë™ë˜êµ¬': { lat: 35.2048, lon: 129.0837, name: 'ë¶€ì‚° ë™ë˜êµ¬' },
    'ë‚¨êµ¬ë¶€ì‚°': { lat: 35.1366, lon: 129.0845, name: 'ë¶€ì‚° ë‚¨êµ¬' },
    'ë¶êµ¬ë¶€ì‚°': { lat: 35.1975, lon: 128.9897, name: 'ë¶€ì‚° ë¶êµ¬' },
    'í•´ìš´ëŒ€êµ¬': { lat: 35.1631, lon: 129.1635, name: 'ë¶€ì‚° í•´ìš´ëŒ€êµ¬' },
    'ì‚¬í•˜êµ¬': { lat: 35.1043, lon: 128.9742, name: 'ë¶€ì‚° ì‚¬í•˜êµ¬' },
    'ê¸ˆì •êµ¬': { lat: 35.2429, lon: 129.0929, name: 'ë¶€ì‚° ê¸ˆì •êµ¬' },
    'ê°•ì„œêµ¬ë¶€ì‚°': { lat: 35.2120, lon: 128.9804, name: 'ë¶€ì‚° ê°•ì„œêµ¬' },
    'ì—°ì œêµ¬': { lat: 35.1765, lon: 129.0785, name: 'ë¶€ì‚° ì—°ì œêµ¬' },
    'ìˆ˜ì˜êµ¬': { lat: 35.1453, lon: 129.1136, name: 'ë¶€ì‚° ìˆ˜ì˜êµ¬' },
    'ì‚¬ìƒêµ¬': { lat: 35.1549, lon: 128.9906, name: 'ë¶€ì‚° ì‚¬ìƒêµ¬' },
    'ê¸°ì¥êµ°': { lat: 35.2446, lon: 129.2224, name: 'ë¶€ì‚° ê¸°ì¥êµ°' },

    // ë¶€ì‚° ì£¼ìš” ì§€ì—­
    'í•´ìš´ëŒ€': { lat: 35.1631, lon: 129.1635, name: 'ë¶€ì‚° í•´ìš´ëŒ€êµ¬' },
    'ê´‘ì•ˆë¦¬': { lat: 35.1532, lon: 129.1183, name: 'ë¶€ì‚° ìˆ˜ì˜êµ¬ ê´‘ì•ˆë¦¬' },
    'ì„œë©´': { lat: 35.1579, lon: 129.0563, name: 'ë¶€ì‚° ë¶€ì‚°ì§„êµ¬ ì„œë©´' },
    'ë‚¨í¬ë™': { lat: 35.0975, lon: 129.0279, name: 'ë¶€ì‚° ì¤‘êµ¬ ë‚¨í¬ë™' },
    'íƒœì¢…ëŒ€': { lat: 35.0516, lon: 129.0875, name: 'ë¶€ì‚° ì˜ë„êµ¬ íƒœì¢…ëŒ€' },
    'ê¸°ì¥': { lat: 35.2446, lon: 129.2224, name: 'ë¶€ì‚° ê¸°ì¥êµ°' },

    // ëŒ€êµ¬ê´‘ì—­ì‹œ
    'ëŒ€êµ¬': { lat: 35.8714, lon: 128.6014, name: 'ëŒ€êµ¬ê´‘ì—­ì‹œ' },
    'ëŒ€êµ¬ì‹œ': { lat: 35.8714, lon: 128.6014, name: 'ëŒ€êµ¬ê´‘ì—­ì‹œ' },
    'ì¤‘êµ¬ëŒ€êµ¬': { lat: 35.8686, lon: 128.6059, name: 'ëŒ€êµ¬ ì¤‘êµ¬' },
    'ë™êµ¬ëŒ€êµ¬': { lat: 35.8896, lon: 128.6355, name: 'ëŒ€êµ¬ ë™êµ¬' },
    'ì„œêµ¬ëŒ€êµ¬': { lat: 35.8719, lon: 128.5592, name: 'ëŒ€êµ¬ ì„œêµ¬' },
    'ë‚¨êµ¬ëŒ€êµ¬': { lat: 35.8464, lon: 128.5974, name: 'ëŒ€êµ¬ ë‚¨êµ¬' },
    'ë¶êµ¬ëŒ€êµ¬': { lat: 35.8858, lon: 128.5829, name: 'ëŒ€êµ¬ ë¶êµ¬' },
    'ìˆ˜ì„±êµ¬': { lat: 35.8581, lon: 128.6311, name: 'ëŒ€êµ¬ ìˆ˜ì„±êµ¬' },
    'ë‹¬ì„œêµ¬': { lat: 35.8328, lon: 128.5327, name: 'ëŒ€êµ¬ ë‹¬ì„œêµ¬' },
    'ë‹¬ì„±êµ°': { lat: 35.7749, lon: 128.4315, name: 'ëŒ€êµ¬ ë‹¬ì„±êµ°' },
    'ë™ì„±ë¡œ': { lat: 35.8686, lon: 128.5950, name: 'ëŒ€êµ¬ ì¤‘êµ¬ ë™ì„±ë¡œ' },

    // ì¸ì²œê´‘ì—­ì‹œ
    'ì¸ì²œ': { lat: 37.4563, lon: 126.7052, name: 'ì¸ì²œê´‘ì—­ì‹œ' },
    'ì¸ì²œì‹œ': { lat: 37.4563, lon: 126.7052, name: 'ì¸ì²œê´‘ì—­ì‹œ' },
    'ì¤‘êµ¬ì¸ì²œ': { lat: 37.4738, lon: 126.6214, name: 'ì¸ì²œ ì¤‘êµ¬' },
    'ë™êµ¬ì¸ì²œ': { lat: 37.4739, lon: 126.6433, name: 'ì¸ì²œ ë™êµ¬' },
    'ë¯¸ì¶”í™€êµ¬': { lat: 37.4639, lon: 126.6505, name: 'ì¸ì²œ ë¯¸ì¶”í™€êµ¬' },
    'ì—°ìˆ˜êµ¬': { lat: 37.4106, lon: 126.6784, name: 'ì¸ì²œ ì—°ìˆ˜êµ¬' },
    'ë‚¨ë™êµ¬': { lat: 37.4468, lon: 126.7312, name: 'ì¸ì²œ ë‚¨ë™êµ¬' },
    'ë¶€í‰êµ¬': { lat: 37.5073, lon: 126.7218, name: 'ì¸ì²œ ë¶€í‰êµ¬' },
    'ê³„ì–‘êµ¬': { lat: 37.5373, lon: 126.7378, name: 'ì¸ì²œ ê³„ì–‘êµ¬' },
    'ì„œêµ¬ì¸ì²œ': { lat: 37.5458, lon: 126.6757, name: 'ì¸ì²œ ì„œêµ¬' },
    'ê°•í™”êµ°': { lat: 37.7473, lon: 126.4877, name: 'ì¸ì²œ ê°•í™”êµ°' },
    'ì˜¹ì§„êµ°': { lat: 37.4465, lon: 126.6362, name: 'ì¸ì²œ ì˜¹ì§„êµ°' },
    'ì†¡ë„': { lat: 37.3894, lon: 126.6541, name: 'ì¸ì²œ ì—°ìˆ˜êµ¬ ì†¡ë„' },
    'ì›”ë¯¸ë„': { lat: 37.4756, lon: 126.5935, name: 'ì¸ì²œ ì¤‘êµ¬ ì›”ë¯¸ë„' },
    'ê°•í™”': { lat: 37.7473, lon: 126.4877, name: 'ì¸ì²œ ê°•í™”êµ°' },
    'ì„ì™•ë¦¬': { lat: 37.4455, lon: 126.3738, name: 'ì¸ì²œ ì¤‘êµ¬ ì„ì™•ë¦¬' },

    // ê´‘ì£¼ê´‘ì—­ì‹œ
    'ê´‘ì£¼': { lat: 35.1595, lon: 126.8526, name: 'ê´‘ì£¼ê´‘ì—­ì‹œ' },
    'ê´‘ì£¼ì‹œ': { lat: 35.1595, lon: 126.8526, name: 'ê´‘ì£¼ê´‘ì—­ì‹œ' },
    'ë™êµ¬ê´‘ì£¼': { lat: 35.1465, lon: 126.9227, name: 'ê´‘ì£¼ ë™êµ¬' },
    'ì„œêµ¬ê´‘ì£¼': { lat: 35.1522, lon: 126.8892, name: 'ê´‘ì£¼ ì„œêµ¬' },
    'ë‚¨êµ¬ê´‘ì£¼': { lat: 35.1330, lon: 126.9026, name: 'ê´‘ì£¼ ë‚¨êµ¬' },
    'ë¶êµ¬ê´‘ì£¼': { lat: 35.1740, lon: 126.9115, name: 'ê´‘ì£¼ ë¶êµ¬' },
    'ê´‘ì‚°êµ¬': { lat: 35.1395, lon: 126.7934, name: 'ê´‘ì£¼ ê´‘ì‚°êµ¬' },
    'ë¬´ë“±ì‚°': { lat: 35.1347, lon: 126.9881, name: 'ê´‘ì£¼ ë™êµ¬ ë¬´ë“±ì‚°' },

    // ëŒ€ì „ê´‘ì—­ì‹œ
    'ëŒ€ì „': { lat: 36.3504, lon: 127.3845, name: 'ëŒ€ì „ê´‘ì—­ì‹œ' },
    'ëŒ€ì „ì‹œ': { lat: 36.3504, lon: 127.3845, name: 'ëŒ€ì „ê´‘ì—­ì‹œ' },
    'ë™êµ¬ëŒ€ì „': { lat: 36.3504, lon: 127.4548, name: 'ëŒ€ì „ ë™êµ¬' },
    'ì¤‘êµ¬ëŒ€ì „': { lat: 36.3256, lon: 127.4211, name: 'ëŒ€ì „ ì¤‘êµ¬' },
    'ì„œêµ¬ëŒ€ì „': { lat: 36.3554, lon: 127.3834, name: 'ëŒ€ì „ ì„œêµ¬' },
    'ìœ ì„±êµ¬': { lat: 36.3621, lon: 127.3565, name: 'ëŒ€ì „ ìœ ì„±êµ¬' },
    'ëŒ€ë•êµ¬': { lat: 36.3467, lon: 127.4154, name: 'ëŒ€ì „ ëŒ€ë•êµ¬' },
    'ìœ ì„±': { lat: 36.3621, lon: 127.3565, name: 'ëŒ€ì „ ìœ ì„±êµ¬' },

    // ìš¸ì‚°ê´‘ì—­ì‹œ
    'ìš¸ì‚°': { lat: 35.5384, lon: 129.3114, name: 'ìš¸ì‚°ê´‘ì—­ì‹œ' },
    'ìš¸ì‚°ì‹œ': { lat: 35.5384, lon: 129.3114, name: 'ìš¸ì‚°ê´‘ì—­ì‹œ' },
    'ì¤‘êµ¬ìš¸ì‚°': { lat: 35.5693, lon: 129.3309, name: 'ìš¸ì‚° ì¤‘êµ¬' },
    'ë‚¨êµ¬ìš¸ì‚°': { lat: 35.5460, lon: 129.3297, name: 'ìš¸ì‚° ë‚¨êµ¬' },
    'ë™êµ¬ìš¸ì‚°': { lat: 35.5049, lon: 129.4167, name: 'ìš¸ì‚° ë™êµ¬' },
    'ë¶êµ¬ìš¸ì‚°': { lat: 35.5827, lon: 129.3612, name: 'ìš¸ì‚° ë¶êµ¬' },
    'ìš¸ì£¼êµ°': { lat: 35.5220, lon: 129.1538, name: 'ìš¸ì‚° ìš¸ì£¼êµ°' },

    // ì„¸ì¢…íŠ¹ë³„ìì¹˜ì‹œ
    'ì„¸ì¢…': { lat: 36.4801, lon: 127.2890, name: 'ì„¸ì¢…íŠ¹ë³„ìì¹˜ì‹œ' },
    'ì„¸ì¢…ì‹œ': { lat: 36.4801, lon: 127.2890, name: 'ì„¸ì¢…íŠ¹ë³„ìì¹˜ì‹œ' },

    // ê²½ê¸°ë„ ì£¼ìš” ë„ì‹œ
    'ìˆ˜ì›': { lat: 37.2636, lon: 127.0286, name: 'ê²½ê¸° ìˆ˜ì›ì‹œ' },
    'ì„±ë‚¨': { lat: 37.4201, lon: 127.1262, name: 'ê²½ê¸° ì„±ë‚¨ì‹œ' },
    'ìš©ì¸': { lat: 37.2411, lon: 127.1776, name: 'ê²½ê¸° ìš©ì¸ì‹œ' },
    'ì•ˆì–‘': { lat: 37.3943, lon: 126.9568, name: 'ê²½ê¸° ì•ˆì–‘ì‹œ' },
    'ì•ˆì‚°': { lat: 37.3236, lon: 126.8219, name: 'ê²½ê¸° ì•ˆì‚°ì‹œ' },
    'ê³ ì–‘': { lat: 37.6584, lon: 126.8320, name: 'ê²½ê¸° ê³ ì–‘ì‹œ' },
    'ê³¼ì²œ': { lat: 37.4292, lon: 126.9876, name: 'ê²½ê¸° ê³¼ì²œì‹œ' },
    'ê´‘ëª…': { lat: 37.4786, lon: 126.8644, name: 'ê²½ê¸° ê´‘ëª…ì‹œ' },
    'ê´‘ì£¼ê²½ê¸°': { lat: 37.4297, lon: 127.2550, name: 'ê²½ê¸° ê´‘ì£¼ì‹œ' },
    'êµ¬ë¦¬': { lat: 37.5943, lon: 127.1296, name: 'ê²½ê¸° êµ¬ë¦¬ì‹œ' },
    'êµ°í¬': { lat: 37.3617, lon: 126.9352, name: 'ê²½ê¸° êµ°í¬ì‹œ' },
    'ê¹€í¬': { lat: 37.6150, lon: 126.7158, name: 'ê²½ê¸° ê¹€í¬ì‹œ' },
    'ë‚¨ì–‘ì£¼': { lat: 37.6369, lon: 127.2167, name: 'ê²½ê¸° ë‚¨ì–‘ì£¼ì‹œ' },
    'ë™ë‘ì²œ': { lat: 37.9034, lon: 127.0606, name: 'ê²½ê¸° ë™ë‘ì²œì‹œ' },
    'ë¶€ì²œ': { lat: 37.5034, lon: 126.7660, name: 'ê²½ê¸° ë¶€ì²œì‹œ' },
    'ì‹œí¥': { lat: 37.3802, lon: 126.8031, name: 'ê²½ê¸° ì‹œí¥ì‹œ' },
    'ì•ˆì„±': { lat: 37.0078, lon: 127.2797, name: 'ê²½ê¸° ì•ˆì„±ì‹œ' },
    'ì–‘ì£¼': { lat: 37.7851, lon: 127.0458, name: 'ê²½ê¸° ì–‘ì£¼ì‹œ' },
    'ì˜¤ì‚°': { lat: 37.1499, lon: 127.0776, name: 'ê²½ê¸° ì˜¤ì‚°ì‹œ' },
    'ì˜ì™•': { lat: 37.3449, lon: 126.9683, name: 'ê²½ê¸° ì˜ì™•ì‹œ' },
    'ì˜ì •ë¶€': { lat: 37.7381, lon: 127.0338, name: 'ê²½ê¸° ì˜ì •ë¶€ì‹œ' },
    'ì´ì²œ': { lat: 37.2720, lon: 127.4349, name: 'ê²½ê¸° ì´ì²œì‹œ' },
    'íŒŒì£¼': { lat: 37.7598, lon: 126.7800, name: 'ê²½ê¸° íŒŒì£¼ì‹œ' },
    'í‰íƒ': { lat: 36.9921, lon: 127.1123, name: 'ê²½ê¸° í‰íƒì‹œ' },
    'í¬ì²œ': { lat: 37.8948, lon: 127.2001, name: 'ê²½ê¸° í¬ì²œì‹œ' },
    'í•˜ë‚¨': { lat: 37.5392, lon: 127.2145, name: 'ê²½ê¸° í•˜ë‚¨ì‹œ' },
    'í™”ì„±': { lat: 37.1997, lon: 126.8312, name: 'ê²½ê¸° í™”ì„±ì‹œ' },
    'ì—¬ì£¼': { lat: 37.2982, lon: 127.6377, name: 'ê²½ê¸° ì—¬ì£¼ì‹œ' },
    'ì—°ì²œ': { lat: 38.0963, lon: 127.0746, name: 'ê²½ê¸° ì—°ì²œêµ°' },
    'ê°€í‰': { lat: 37.8314, lon: 127.5109, name: 'ê²½ê¸° ê°€í‰êµ°' },
    'ì–‘í‰': { lat: 37.4919, lon: 127.4873, name: 'ê²½ê¸° ì–‘í‰êµ°' },

    // ê°•ì›ë„ (ì „ì²´)
    'ì¶˜ì²œ': { lat: 37.8816, lon: 127.7292, name: 'ê°•ì› ì¶˜ì²œì‹œ' },
    'ì›ì£¼': { lat: 37.3422, lon: 127.9200, name: 'ê°•ì› ì›ì£¼ì‹œ' },
    'ê°•ë¦‰': { lat: 37.7519, lon: 128.8758, name: 'ê°•ì› ê°•ë¦‰ì‹œ' },
    'ë™í•´': { lat: 37.5255, lon: 129.1177, name: 'ê°•ì› ë™í•´ì‹œ' },
    'íƒœë°±': { lat: 37.1648, lon: 128.9859, name: 'ê°•ì› íƒœë°±ì‹œ' },
    'ì†ì´ˆ': { lat: 38.2036, lon: 128.5647, name: 'ê°•ì› ì†ì´ˆì‹œ' },
    'ì‚¼ì²™': { lat: 37.4475, lon: 129.1678, name: 'ê°•ì› ì‚¼ì²™ì‹œ' },
    'í™ì²œ': { lat: 37.8860, lon: 127.8845, name: 'ê°•ì› í™ì²œêµ°' },
    'íš¡ì„±': { lat: 37.4920, lon: 127.9830, name: 'ê°•ì› íš¡ì„±êµ°' },
    'ì˜ì›”': { lat: 37.1852, lon: 128.4687, name: 'ê°•ì› ì˜ì›”êµ°' },
    'í‰ì°½': { lat: 37.3712, lon: 128.3970, name: 'ê°•ì› í‰ì°½êµ°' },
    'ì •ì„ ': { lat: 37.3807, lon: 128.6607, name: 'ê°•ì› ì •ì„ êµ°' },
    'ì² ì›': { lat: 38.1467, lon: 127.3130, name: 'ê°•ì› ì² ì›êµ°' },
    'í™”ì²œ': { lat: 38.1063, lon: 127.7084, name: 'ê°•ì› í™”ì²œêµ°' },
    'ì–‘êµ¬': { lat: 38.1103, lon: 127.9898, name: 'ê°•ì› ì–‘êµ¬êµ°' },
    'ì¸ì œ': { lat: 38.0695, lon: 128.1709, name: 'ê°•ì› ì¸ì œêµ°' },
    'ê³ ì„±ê°•ì›': { lat: 38.3797, lon: 128.4677, name: 'ê°•ì› ê³ ì„±êµ°' },
    'ê³ ì„±': { lat: 38.3797, lon: 128.4677, name: 'ê°•ì› ê³ ì„±êµ°' }, // ê¸°ë³¸ê°’ì€ ê°•ì› ê³ ì„±
    'ì–‘ì–‘': { lat: 38.0759, lon: 128.6190, name: 'ê°•ì› ì–‘ì–‘êµ°' },

    // ê°•ì›ë„ ì£¼ìš” ê´€ê´‘ì§€
    'ì„¤ì•…ì‚°': { lat: 38.1194, lon: 128.4654, name: 'ê°•ì› ì„¤ì•…ì‚°êµ­ë¦½ê³µì›' },
    'ì˜¤ëŒ€ì‚°': { lat: 37.7971, lon: 128.5436, name: 'ê°•ì› ì˜¤ëŒ€ì‚°êµ­ë¦½ê³µì›' },
    'ì •ë™ì§„': { lat: 37.6896, lon: 129.0336, name: 'ê°•ì› ê°•ë¦‰ì‹œ ì •ë™ì§„' },

    // ì¶©ì²­ë¶ë„ (ì „ì²´)
    'ì²­ì£¼': { lat: 36.6424, lon: 127.4890, name: 'ì¶©ë¶ ì²­ì£¼ì‹œ' },
    'ì¶©ì£¼': { lat: 36.9910, lon: 127.9259, name: 'ì¶©ë¶ ì¶©ì£¼ì‹œ' },
    'ì œì²œ': { lat: 37.1326, lon: 128.1906, name: 'ì¶©ë¶ ì œì²œì‹œ' },
    'ë³´ì€': { lat: 36.4895, lon: 127.7294, name: 'ì¶©ë¶ ë³´ì€êµ°' },
    'ì˜¥ì²œ': { lat: 36.3062, lon: 127.5720, name: 'ì¶©ë¶ ì˜¥ì²œêµ°' },
    'ì˜ë™': { lat: 36.1750, lon: 127.7764, name: 'ì¶©ë¶ ì˜ë™êµ°' },
    'ì¦í‰': { lat: 36.7808, lon: 127.5814, name: 'ì¶©ë¶ ì¦í‰êµ°' },
    'ì§„ì²œ': { lat: 36.8553, lon: 127.4335, name: 'ì¶©ë¶ ì§„ì²œêµ°' },
    'ê´´ì‚°': { lat: 36.8156, lon: 127.7879, name: 'ì¶©ë¶ ê´´ì‚°êµ°' },
    'ìŒì„±': { lat: 36.9441, lon: 127.6868, name: 'ì¶©ë¶ ìŒì„±êµ°' },
    'ë‹¨ì–‘': { lat: 36.9845, lon: 128.3659, name: 'ì¶©ë¶ ë‹¨ì–‘êµ°' },

    // ì¶©ì²­ë‚¨ë„ (ì „ì²´)
    'ì²œì•ˆ': { lat: 36.8151, lon: 127.1139, name: 'ì¶©ë‚¨ ì²œì•ˆì‹œ' },
    'ê³µì£¼': { lat: 36.4465, lon: 127.1189, name: 'ì¶©ë‚¨ ê³µì£¼ì‹œ' },
    'ë³´ë ¹': { lat: 36.3332, lon: 126.6123, name: 'ì¶©ë‚¨ ë³´ë ¹ì‹œ' },
    'ì•„ì‚°': { lat: 36.7898, lon: 127.0018, name: 'ì¶©ë‚¨ ì•„ì‚°ì‹œ' },
    'ì„œì‚°': { lat: 36.7848, lon: 126.4503, name: 'ì¶©ë‚¨ ì„œì‚°ì‹œ' },
    'ë…¼ì‚°': { lat: 36.1872, lon: 127.0986, name: 'ì¶©ë‚¨ ë…¼ì‚°ì‹œ' },
    'ê³„ë£¡': { lat: 36.2743, lon: 127.2487, name: 'ì¶©ë‚¨ ê³„ë£¡ì‹œ' },
    'ë‹¹ì§„': { lat: 36.8937, lon: 126.6297, name: 'ì¶©ë‚¨ ë‹¹ì§„ì‹œ' },
    'ê¸ˆì‚°': { lat: 36.1089, lon: 127.4881, name: 'ì¶©ë‚¨ ê¸ˆì‚°êµ°' },
    'ë¶€ì—¬': { lat: 36.2756, lon: 126.9100, name: 'ì¶©ë‚¨ ë¶€ì—¬êµ°' },
    'ì„œì²œ': { lat: 36.0814, lon: 126.6919, name: 'ì¶©ë‚¨ ì„œì²œêµ°' },
    'ì²­ì–‘': { lat: 36.4592, lon: 126.8025, name: 'ì¶©ë‚¨ ì²­ì–‘êµ°' },
    'í™ì„±': { lat: 36.6014, lon: 126.6608, name: 'ì¶©ë‚¨ í™ì„±êµ°' },
    'ì˜ˆì‚°': { lat: 36.6818, lon: 126.8497, name: 'ì¶©ë‚¨ ì˜ˆì‚°êµ°' },
    'íƒœì•ˆ': { lat: 36.7455, lon: 126.2980, name: 'ì¶©ë‚¨ íƒœì•ˆêµ°' },

    // ì¶©ë‚¨ ì£¼ìš” ê´€ê´‘ì§€
    'íƒœì•ˆì•ˆë©´ë„': { lat: 36.5262, lon: 126.3340, name: 'ì¶©ë‚¨ íƒœì•ˆ ì•ˆë©´ë„' },

    // ì „ë¼ë¶ë„ (ì „ì²´)
    'ì „ì£¼': { lat: 35.8242, lon: 127.1480, name: 'ì „ë¶ ì „ì£¼ì‹œ' },
    'êµ°ì‚°': { lat: 35.9677, lon: 126.7366, name: 'ì „ë¶ êµ°ì‚°ì‹œ' },
    'ìµì‚°': { lat: 35.9483, lon: 126.9575, name: 'ì „ë¶ ìµì‚°ì‹œ' },
    'ì •ì': { lat: 35.5697, lon: 126.8561, name: 'ì „ë¶ ì •ìì‹œ' },
    'ë‚¨ì›ì „ë¶': { lat: 35.4163, lon: 127.3906, name: 'ì „ë¶ ë‚¨ì›ì‹œ' },
    'ë‚¨ì›': { lat: 35.4163, lon: 127.3906, name: 'ì „ë¶ ë‚¨ì›ì‹œ' }, // ê¸°ë³¸ê°’ì€ ì „ë¶ ë‚¨ì›
    'ê¹€ì œ': { lat: 35.8035, lon: 126.8809, name: 'ì „ë¶ ê¹€ì œì‹œ' },
    'ì™„ì£¼': { lat: 35.9052, lon: 127.1605, name: 'ì „ë¶ ì™„ì£¼êµ°' },
    'ì§„ì•ˆ': { lat: 35.7917, lon: 127.4249, name: 'ì „ë¶ ì§„ì•ˆêµ°' },
    'ë¬´ì£¼': { lat: 36.0073, lon: 127.6608, name: 'ì „ë¶ ë¬´ì£¼êµ°' },
    'ì¥ìˆ˜': { lat: 35.6477, lon: 127.5199, name: 'ì „ë¶ ì¥ìˆ˜êµ°' },
    'ì„ì‹¤': { lat: 35.6176, lon: 127.2896, name: 'ì „ë¶ ì„ì‹¤êµ°' },
    'ìˆœì°½': { lat: 35.3744, lon: 127.1375, name: 'ì „ë¶ ìˆœì°½êµ°' },
    'ê³ ì°½': { lat: 35.4347, lon: 126.7022, name: 'ì „ë¶ ê³ ì°½êµ°' },
    'ë¶€ì•ˆ': { lat: 35.7318, lon: 126.7330, name: 'ì „ë¶ ë¶€ì•ˆêµ°' },

    // ì „ë¶ ì£¼ìš” ê´€ê´‘ì§€
    'ì „ì£¼í•œì˜¥ë§ˆì„': { lat: 35.8154, lon: 127.1530, name: 'ì „ë¶ ì „ì£¼ í•œì˜¥ë§ˆì„' },
    'ë‚´ì¥ì‚°': { lat: 35.4981, lon: 126.8936, name: 'ì „ë¶ ì •ì ë‚´ì¥ì‚°' },
    'ë³€ì‚°ë°˜ë„': { lat: 35.6184, lon: 126.4862, name: 'ì „ë¶ ë¶€ì•ˆ ë³€ì‚°ë°˜ë„' },
    'ë¶€ì•ˆì±„ì„ê°•': { lat: 35.6184, lon: 126.4862, name: 'ì „ë¶ ë¶€ì•ˆ ì±„ì„ê°•' },
    'ê³ ì°½ê³ ì¸ëŒ': { lat: 35.4347, lon: 126.7022, name: 'ì „ë¶ ê³ ì°½ ê³ ì¸ëŒ' },

    // ì „ë¼ë‚¨ë„ (ì „ì²´)
    'ëª©í¬': { lat: 34.8118, lon: 126.3922, name: 'ì „ë‚¨ ëª©í¬ì‹œ' },
    'ì—¬ìˆ˜': { lat: 34.7604, lon: 127.6622, name: 'ì „ë‚¨ ì—¬ìˆ˜ì‹œ' },
    'ìˆœì²œ': { lat: 34.9507, lon: 127.4872, name: 'ì „ë‚¨ ìˆœì²œì‹œ' },
    'ë‚˜ì£¼': { lat: 35.0160, lon: 126.7107, name: 'ì „ë‚¨ ë‚˜ì£¼ì‹œ' },
    'ê´‘ì–‘': { lat: 34.9407, lon: 127.5959, name: 'ì „ë‚¨ ê´‘ì–‘ì‹œ' },
    'ë‹´ì–‘': { lat: 35.3215, lon: 126.9881, name: 'ì „ë‚¨ ë‹´ì–‘êµ°' },
    'ê³¡ì„±': { lat: 35.2819, lon: 127.2918, name: 'ì „ë‚¨ ê³¡ì„±êµ°' },
    'êµ¬ë¡€': { lat: 35.2020, lon: 127.4632, name: 'ì „ë‚¨ êµ¬ë¡€êµ°' },
    'ê³ í¥': { lat: 34.6114, lon: 127.2854, name: 'ì „ë‚¨ ê³ í¥êµ°' },
    'ë³´ì„±': { lat: 34.7714, lon: 127.0800, name: 'ì „ë‚¨ ë³´ì„±êµ°' },
    'í™”ìˆœ': { lat: 35.0646, lon: 126.9864, name: 'ì „ë‚¨ í™”ìˆœêµ°' },
    'ì¥í¥': { lat: 34.6811, lon: 126.9066, name: 'ì „ë‚¨ ì¥í¥êµ°' },
    'ê°•ì§„': { lat: 34.6420, lon: 126.7669, name: 'ì „ë‚¨ ê°•ì§„êµ°' },
    'í•´ë‚¨': { lat: 34.5736, lon: 126.5990, name: 'ì „ë‚¨ í•´ë‚¨êµ°' },
    'ì˜ì•”': { lat: 34.8004, lon: 126.6967, name: 'ì „ë‚¨ ì˜ì•”êµ°' },
    'ë¬´ì•ˆ': { lat: 34.9906, lon: 126.4819, name: 'ì „ë‚¨ ë¬´ì•ˆêµ°' },
    'í•¨í‰': { lat: 35.0665, lon: 126.5165, name: 'ì „ë‚¨ í•¨í‰êµ°' },
    'ì˜ê´‘': { lat: 35.2773, lon: 126.5122, name: 'ì „ë‚¨ ì˜ê´‘êµ°' },
    'ì¥ì„±': { lat: 35.3018, lon: 126.7886, name: 'ì „ë‚¨ ì¥ì„±êµ°' },
    'ì™„ë„': { lat: 34.3110, lon: 126.7552, name: 'ì „ë‚¨ ì™„ë„êµ°' },
    'ì§„ë„': { lat: 34.4867, lon: 126.2635, name: 'ì „ë‚¨ ì§„ë„êµ°' },
    'ì‹ ì•ˆ': { lat: 34.8328, lon: 126.1068, name: 'ì „ë‚¨ ì‹ ì•ˆêµ°' },

    // ì „ë‚¨ ì£¼ìš” ê´€ê´‘ì§€
    'ì—¬ìˆ˜ì—‘ìŠ¤í¬': { lat: 34.7604, lon: 127.6622, name: 'ì „ë‚¨ ì—¬ìˆ˜ ì—‘ìŠ¤í¬' },
    'ë³´ì„±ë…¹ì°¨ë°­': { lat: 34.7714, lon: 127.0800, name: 'ì „ë‚¨ ë³´ì„± ë…¹ì°¨ë°­' },
    'ë‹´ì–‘ì£½ë…¹ì›': { lat: 35.3215, lon: 126.9881, name: 'ì „ë‚¨ ë‹´ì–‘ ì£½ë…¹ì›' },
    'ì™„ë„ì²­ì‚°ë„': { lat: 34.1372, lon: 126.8515, name: 'ì „ë‚¨ ì™„ë„ ì²­ì‚°ë„' },
    'ì§„ë„ì‹ ë¹„ì˜ë°”ë‹·ê¸¸': { lat: 34.4867, lon: 126.2635, name: 'ì „ë‚¨ ì§„ë„ ì‹ ë¹„ì˜ë°”ë‹·ê¸¸' },

    // ê²½ìƒë¶ë„ (ì „ì²´)
    'í¬í•­': { lat: 36.0190, lon: 129.3435, name: 'ê²½ë¶ í¬í•­ì‹œ' },
    'ê²½ì£¼': { lat: 35.8562, lon: 129.2247, name: 'ê²½ë¶ ê²½ì£¼ì‹œ' },
    'ê¹€ì²œ': { lat: 36.1395, lon: 128.1137, name: 'ê²½ë¶ ê¹€ì²œì‹œ' },
    'ì•ˆë™': { lat: 36.5684, lon: 128.7294, name: 'ê²½ë¶ ì•ˆë™ì‹œ' },
    'êµ¬ë¯¸': { lat: 36.1196, lon: 128.3441, name: 'ê²½ë¶ êµ¬ë¯¸ì‹œ' },
    'ì˜ì£¼': { lat: 36.8056, lon: 128.6239, name: 'ê²½ë¶ ì˜ì£¼ì‹œ' },
    'ì˜ì²œ': { lat: 35.9733, lon: 128.9386, name: 'ê²½ë¶ ì˜ì²œì‹œ' },
    'ìƒì£¼': { lat: 36.4109, lon: 128.1589, name: 'ê²½ë¶ ìƒì£¼ì‹œ' },
    'ë¬¸ê²½': { lat: 36.5869, lon: 128.1866, name: 'ê²½ë¶ ë¬¸ê²½ì‹œ' },
    'ê²½ì‚°': { lat: 35.8251, lon: 128.7411, name: 'ê²½ë¶ ê²½ì‚°ì‹œ' },
    'êµ°ìœ„': { lat: 36.2395, lon: 128.5735, name: 'ê²½ë¶ êµ°ìœ„êµ°' },
    'ì˜ì„±': { lat: 36.3524, lon: 128.6977, name: 'ê²½ë¶ ì˜ì„±êµ°' },
    'ì²­ì†¡': { lat: 36.4359, lon: 129.0570, name: 'ê²½ë¶ ì²­ì†¡êµ°' },
    'ì˜ì–‘': { lat: 36.6666, lon: 129.1123, name: 'ê²½ë¶ ì˜ì–‘êµ°' },
    'ì˜ë•': { lat: 36.4152, lon: 129.3658, name: 'ê²½ë¶ ì˜ë•êµ°' },
    'ì²­ë„': { lat: 35.6506, lon: 128.7364, name: 'ê²½ë¶ ì²­ë„êµ°' },
    'ê³ ë ¹': { lat: 35.7284, lon: 128.2637, name: 'ê²½ë¶ ê³ ë ¹êµ°' },
    'ì„±ì£¼': { lat: 35.9196, lon: 128.2830, name: 'ê²½ë¶ ì„±ì£¼êµ°' },
    'ì¹ ê³¡': { lat: 35.9942, lon: 128.4017, name: 'ê²½ë¶ ì¹ ê³¡êµ°' },
    'ì˜ˆì²œ': { lat: 36.6554, lon: 128.4517, name: 'ê²½ë¶ ì˜ˆì²œêµ°' },
    'ë´‰í™”': { lat: 36.8930, lon: 128.7322, name: 'ê²½ë¶ ë´‰í™”êµ°' },
    'ìš¸ì§„': { lat: 36.9930, lon: 129.4006, name: 'ê²½ë¶ ìš¸ì§„êµ°' },
    'ìš¸ë¦‰ë„': { lat: 37.4845, lon: 130.9057, name: 'ê²½ë¶ ìš¸ë¦‰êµ°' },

    // ê²½ë¶ ì£¼ìš” ê´€ê´‘ì§€
    'ê²½ì£¼ì—­ì‚¬ìœ ì ì§€êµ¬': { lat: 35.8562, lon: 129.2247, name: 'ê²½ë¶ ê²½ì£¼ ì—­ì‚¬ìœ ì ì§€êµ¬' },
    'ì•ˆë™í•˜íšŒë§ˆì„': { lat: 36.5397, lon: 128.5188, name: 'ê²½ë¶ ì•ˆë™ í•˜íšŒë§ˆì„' },

    // ê²½ìƒë‚¨ë„ (ì „ì²´)
    'ì°½ì›': { lat: 35.2281, lon: 128.6811, name: 'ê²½ë‚¨ ì°½ì›ì‹œ' },
    'ì§„ì£¼': { lat: 35.1800, lon: 128.1076, name: 'ê²½ë‚¨ ì§„ì£¼ì‹œ' },
    'í†µì˜': { lat: 34.8544, lon: 128.4331, name: 'ê²½ë‚¨ í†µì˜ì‹œ' },
    'ì‚¬ì²œ': { lat: 35.0036, lon: 128.0645, name: 'ê²½ë‚¨ ì‚¬ì²œì‹œ' },
    'ê¹€í•´': { lat: 35.2342, lon: 128.8896, name: 'ê²½ë‚¨ ê¹€í•´ì‹œ' },
    'ë°€ì–‘': { lat: 35.5040, lon: 128.7469, name: 'ê²½ë‚¨ ë°€ì–‘ì‹œ' },
    'ê±°ì œ': { lat: 34.8806, lon: 128.6212, name: 'ê²½ë‚¨ ê±°ì œì‹œ' },
    'ì–‘ì‚°': { lat: 35.3350, lon: 129.0375, name: 'ê²½ë‚¨ ì–‘ì‚°ì‹œ' },
    'ì˜ë ¹': { lat: 35.3220, lon: 128.2618, name: 'ê²½ë‚¨ ì˜ë ¹êµ°' },
    'í•¨ì•ˆ': { lat: 35.2732, lon: 128.4065, name: 'ê²½ë‚¨ í•¨ì•ˆêµ°' },
    'ì°½ë…•': { lat: 35.5444, lon: 128.4925, name: 'ê²½ë‚¨ ì°½ë…•êµ°' },
    'ê³ ì„±ê²½ë‚¨': { lat: 34.9733, lon: 128.3229, name: 'ê²½ë‚¨ ê³ ì„±êµ°' },
    'ë‚¨í•´': { lat: 34.8375, lon: 127.8926, name: 'ê²½ë‚¨ ë‚¨í•´êµ°' },
    'í•˜ë™': { lat: 35.0677, lon: 127.7514, name: 'ê²½ë‚¨ í•˜ë™êµ°' },
    'ì‚°ì²­': { lat: 35.4151, lon: 127.8736, name: 'ê²½ë‚¨ ì‚°ì²­êµ°' },
    'í•¨ì–‘': { lat: 35.5205, lon: 127.7248, name: 'ê²½ë‚¨ í•¨ì–‘êµ°' },
    'ê±°ì°½': { lat: 35.6869, lon: 127.9095, name: 'ê²½ë‚¨ ê±°ì°½êµ°' },
    'í•©ì²œ': { lat: 35.5665, lon: 128.1655, name: 'ê²½ë‚¨ í•©ì²œêµ°' },

    // ê²½ë‚¨ ì£¼ìš” ê´€ê´‘ì§€
    'í†µì˜ì¼€ì´ë¸”ì¹´': { lat: 34.8544, lon: 128.4331, name: 'ê²½ë‚¨ í†µì˜ ì¼€ì´ë¸”ì¹´' },
    'ê±°ì œì™¸ë„': { lat: 34.7996, lon: 128.6945, name: 'ê²½ë‚¨ ê±°ì œ ì™¸ë„' },
    'ë‚¨í•´ë…ì¼ë§ˆì„': { lat: 34.8375, lon: 127.8926, name: 'ê²½ë‚¨ ë‚¨í•´ ë…ì¼ë§ˆì„' },

    // ì œì£¼íŠ¹ë³„ìì¹˜ë„ (ì „ì²´) - ì„¸ë¶„í™” ìœ ì§€
    'ì œì£¼': { lat: 33.4996, lon: 126.5312, name: 'ì œì£¼íŠ¹ë³„ìì¹˜ë„' },
    'ì œì£¼ì‹œ': { lat: 33.5097, lon: 126.5219, name: 'ì œì£¼ì‹œ' },
    'ì„œê·€í¬': { lat: 33.2541, lon: 126.5601, name: 'ì„œê·€í¬ì‹œ' },
    'ì„±ì‚°': { lat: 33.4615, lon: 126.9410, name: 'ì œì£¼ ì„±ì‚°ì' },
    'ì¤‘ë¬¸': { lat: 33.2394, lon: 126.4128, name: 'ì œì£¼ ì¤‘ë¬¸ê´€ê´‘ë‹¨ì§€' },
    'í•œë¦¼': { lat: 33.4144, lon: 126.2692, name: 'ì œì£¼ í•œë¦¼ì' },
    'ì• ì›”': { lat: 33.4618, lon: 126.3314, name: 'ì œì£¼ ì• ì›”ì' },
    'í‘œì„ ': { lat: 33.3274, lon: 126.8394, name: 'ì œì£¼ í‘œì„ ë©´' },
    'ëŒ€ì •': { lat: 33.2169, lon: 126.2394, name: 'ì œì£¼ ëŒ€ì •ì' },
    'í•œë¼ì‚°': { lat: 33.3617, lon: 126.5292, name: 'ì œì£¼ í•œë¼ì‚°' },
    'ìš°ë„': { lat: 33.5009, lon: 126.9506, name: 'ì œì£¼ ìš°ë„' },
    'ë§ˆë¼ë„': { lat: 33.1170, lon: 126.2687, name: 'ì œì£¼ ë§ˆë¼ë„' },
    'ë‚¨ì›ì œì£¼': { lat: 33.2594, lon: 126.7136, name: 'ì œì£¼ ë‚¨ì›ì' },
    'êµ¬ì¢Œ': { lat: 33.5567, lon: 126.8394, name: 'ì œì£¼ êµ¬ì¢Œì' },
    'ì¡°ì²œ': { lat: 33.5567, lon: 126.6394, name: 'ì œì£¼ ì¡°ì²œì' },
    'í•œê²½': { lat: 33.3567, lon: 126.1894, name: 'ì œì£¼ í•œê²½ë©´' },
    'ì¶”ì': { lat: 33.9567, lon: 126.2994, name: 'ì œì£¼ ì¶”ìë©´' },

    // ì œì£¼ ì£¼ìš” ê´€ê´‘ì§€
    'í•œë¼ì‚°êµ­ë¦½ê³µì›': { lat: 33.3617, lon: 126.5292, name: 'ì œì£¼ í•œë¼ì‚°êµ­ë¦½ê³µì›' },

    // ê¸°íƒ€ ì£¼ìš” êµ­ë¦½ê³µì› ë° ê´€ê´‘ì§€
    'ì„¤ì•…ì‚°êµ­ë¦½ê³µì›': { lat: 38.1194, lon: 128.4654, name: 'ì„¤ì•…ì‚°êµ­ë¦½ê³µì›' },
    'ì§€ë¦¬ì‚°êµ­ë¦½ê³µì›': { lat: 35.3384, lon: 127.7303, name: 'ì§€ë¦¬ì‚°êµ­ë¦½ê³µì›' },
    'ë¶í•œì‚°êµ­ë¦½ê³µì›': { lat: 37.6583, lon: 126.9778, name: 'ë¶í•œì‚°êµ­ë¦½ê³µì›' },
    'ì†Œë°±ì‚°êµ­ë¦½ê³µì›': { lat: 36.9583, lon: 128.4778, name: 'ì†Œë°±ì‚°êµ­ë¦½ê³µì›' },
    'ì£¼ì™•ì‚°êµ­ë¦½ê³µì›': { lat: 36.3583, lon: 129.1778, name: 'ì£¼ì™•ì‚°êµ­ë¦½ê³µì›' },
    'ê°€ì•¼ì‚°êµ­ë¦½ê³µì›': { lat: 35.8183, lon: 128.1178, name: 'ê°€ì•¼ì‚°êµ­ë¦½ê³µì›' },
    'ë•ìœ ì‚°êµ­ë¦½ê³µì›': { lat: 35.8583, lon: 127.7478, name: 'ë•ìœ ì‚°êµ­ë¦½ê³µì›' },
    'ê³„ë£¡ì‚°êµ­ë¦½ê³µì›': { lat: 36.3483, lon: 127.2178, name: 'ê³„ë£¡ì‚°êµ­ë¦½ê³µì›' },
    'ì¹˜ì•…ì‚°êµ­ë¦½ê³µì›': { lat: 37.3783, lon: 128.0578, name: 'ì¹˜ì•…ì‚°êµ­ë¦½ê³µì›' },
    'íƒœë°±ì‚°êµ­ë¦½ê³µì›': { lat: 37.0983, lon: 128.9178, name: 'íƒœë°±ì‚°êµ­ë¦½ê³µì›' },
    'ë¬´ë“±ì‚°êµ­ë¦½ê³µì›': { lat: 35.1347, lon: 126.9881, name: 'ë¬´ë“±ì‚°êµ­ë¦½ê³µì›' },
    'ì›”ì¶œì‚°êµ­ë¦½ê³µì›': { lat: 34.7583, lon: 126.7078, name: 'ì›”ì¶œì‚°êµ­ë¦½ê³µì›' },
    'ë‹¤ë„í•´í•´ìƒêµ­ë¦½ê³µì›': { lat: 34.3583, lon: 126.7578, name: 'ë‹¤ë„í•´í•´ìƒêµ­ë¦½ê³µì›' },
    'í•œë ¤í•´ìƒêµ­ë¦½ê³µì›': { lat: 34.8583, lon: 128.4578, name: 'í•œë ¤í•´ìƒêµ­ë¦½ê³µì›' },
    'íƒœì•ˆí•´ì•ˆêµ­ë¦½ê³µì›': { lat: 36.7583, lon: 126.2978, name: 'íƒœì•ˆí•´ì•ˆêµ­ë¦½ê³µì›' },

    // ì¶”ê°€ ê´€ê´‘ ëª…ì†Œ
    'ë¶€ì—¬ë°±ì œë¬¸í™”ë‹¨ì§€': { lat: 36.2756, lon: 126.9100, name: 'ì¶©ë‚¨ ë¶€ì—¬ ë°±ì œë¬¸í™”ë‹¨ì§€' },
    'ë‹¨ì–‘ë„ë‹´ì‚¼ë´‰': { lat: 36.9845, lon: 128.3659, name: 'ì¶©ë¶ ë‹¨ì–‘ ë„ë‹´ì‚¼ë´‰' },
    'ì†ì´ˆí•´ìˆ˜ìš•ì¥': { lat: 38.2070, lon: 128.5918, name: 'ê°•ì› ì†ì´ˆ í•´ìˆ˜ìš•ì¥' },
    'ê°•ë¦‰ê²½í¬ëŒ€': { lat: 37.7883, lon: 128.9083, name: 'ê°•ì› ê°•ë¦‰ ê²½í¬ëŒ€' },
    'í‰ì°½ì˜¬ë¦¼í”½íŒŒí¬': { lat: 37.6583, lon: 128.6778, name: 'ê°•ì› í‰ì°½ ì˜¬ë¦¼í”½íŒŒí¬' }
  };
}

/**
 * ì§€ì—­ëª… ì •ê·œí™” ë° ê²€ìƒ‰
 * @param {string} query - ì‚¬ìš©ì ì…ë ¥ ì§€ì—­ëª…
 * @returns {Object} ë§¤ì¹­ëœ ì§€ì—­ì˜ ì¢Œí‘œ ë° ì´ë¦„ ì •ë³´
 */
function findLocationCoordinates(query) {
    const locations = getLocationCoordinates();

    // ì •í™•í•œ ë§¤ì¹­ ìš°ì„ 
    if (locations[query]) {
        return locations[query];
    }

    // ì •ê·œí™”ëœ ê²€ìƒ‰
    const normalizedQuery = query.toLowerCase()
        .replace(/\s+/g, '')
        .replace(/[ì‹œêµ°êµ¬ìë©´ë™ë¦¬]/g, '')
        .replace(/íŠ¹ë³„ìì¹˜ë„|ê´‘ì—­ì‹œ|íŠ¹ë³„ìì¹˜ì‹œ|íŠ¹ë³„ì‹œ|ë„$/g, '');

    // í‚¤ ê¸°ë°˜ ê²€ìƒ‰
    for (const [key, coords] of Object.entries(locations)) {
        const normalizedKey = key.toLowerCase()
            .replace(/\s+/g, '')
            .replace(/[ì‹œêµ°êµ¬ìë©´ë™ë¦¬]/g, '')
            .replace(/íŠ¹ë³„ìì¹˜ë„|ê´‘ì—­ì‹œ|íŠ¹ë³„ìì¹˜ì‹œ|íŠ¹ë³„ì‹œ|ë„$/g, '');

        if (normalizedKey.includes(normalizedQuery) || normalizedQuery.includes(normalizedKey)) {
            console.log(`ì§€ì—­ëª… ë§¤ì¹­: ${query} -> ${key} (${coords.name})`);
            return coords;
        }
    }

    // ì´ë¦„ ê¸°ë°˜ ê²€ìƒ‰
    for (const [key, coords] of Object.entries(locations)) {
        const normalizedName = coords.name.toLowerCase()
            .replace(/\s+/g, '')
            .replace(/[ì‹œêµ°êµ¬ìë©´ë™ë¦¬]/g, '');

        if (normalizedName.includes(normalizedQuery) || normalizedQuery.includes(normalizedName)) {
            console.log(`ì´ë¦„ ë§¤ì¹­: ${query} -> ${coords.name}`);
            return coords;
        }
    }

    // ê¸°ë³¸ê°’: ì„œìš¸ (ì „êµ­ ê´€ê´‘ì„ ìœ„í•œ ê¸°ë³¸ê°’)
    console.log(`ë§¤ì¹­ ì‹¤íŒ¨, ê¸°ë³¸ê°’ ì‚¬ìš©: ${query} -> ${DEFAULT_REGION}`);
    return locations[DEFAULT_REGION];
}

/**
 * ê¸°ìƒì²­ API ì‘ë‹µ ë°ì´í„°ë¥¼ ê°€ê³µí•˜ì—¬ 3ì¼ê°„ì˜ ì™„ì „í•œ ë‚ ì”¨ ì •ë³´ ë°˜í™˜
 * @param {Array} items - ê¸°ìƒì²­ APIì—ì„œ ë°˜í™˜ëœ ë‚ ì”¨ ë°ì´í„° í•­ëª© ë°°ì—´
 * @param {Date} kst - í•œêµ­ í‘œì¤€ì‹œ Date ê°ì²´
 * @returns {Array} ê°€ê³µëœ 3ì¼ê°„ì˜ ë‚ ì”¨ ë°ì´í„° ë°°ì—´
 */
function processCompleteWeatherData(items, kst) {
    const forecasts = {};

    // ì˜¤ëŠ˜, ë‚´ì¼, ëª¨ë ˆ ë‚ ì§œ ê³„ì‚°
    const today = kst.toISOString().slice(0, 10).replace(/-/g, '');
    const tomorrow = new Date(kst.getTime() + 24 * 60 * 60 * 1000).toISOString().slice(0, 10).replace(/-/g, '');
    const dayAfter = new Date(kst.getTime() + 48 * 60 * 60 * 1000).toISOString().slice(0, 10).replace(/-/g, '');

    // ëª¨ë“  ê¸°ìƒ ë°ì´í„° ë¶„ë¥˜
    items.forEach(item => {
        const date = item.fcstDate;
        const time = item.fcstTime;
        const category = item.category;
        const value = item.fcstValue;

        if (!forecasts[date]) {
            forecasts[date] = {
                times: {},
                dailyData: {
                    temperatureMin: null,
                    temperatureMax: null,
                    precipitationProbabilityMax: 0
                }
            };
        }

        if (!forecasts[date].times[time]) {
            forecasts[date].times[time] = {};
        }

        forecasts[date].times[time][category] = value;

        // ì¼ë³„ ìµœì €/ìµœê³  ê¸°ì˜¨ ë° ìµœëŒ€ ê°•ìˆ˜í™•ë¥  ì¶”ì¶œ
        if (category === 'TMN' && value) {
            forecasts[date].dailyData.temperatureMin = parseFloat(value);
        }
        if (category === 'TMX' && value) {
            forecasts[date].dailyData.temperatureMax = parseFloat(value);
        }
        if (category === 'POP' && value) {
            const pop = parseFloat(value);
            if (pop > forecasts[date].dailyData.precipitationProbabilityMax) {
                forecasts[date].dailyData.precipitationProbabilityMax = pop;
            }
        }
    });

    // 3ì¼ê°„ ì™„ì „í•œ ë‚ ì”¨ ë°ì´í„° ìƒì„±
    const result = [];
    [today, tomorrow, dayAfter].forEach((date, index) => {
        if (forecasts[date]) {
            const dayData = extractCompleteWeatherData(forecasts[date], date);
            dayData.dayLabel = index === 0 ? 'ì˜¤ëŠ˜' : index === 1 ? 'ë‚´ì¼' : 'ëª¨ë ˆ';
            dayData.dayIndex = index;
            result.push(dayData);
        }
    });

    return result;
}

/**
 * ì¼ë³„ ë‚ ì”¨ ë°ì´í„°ì—ì„œ í•„ìš”í•œ ì •ë³´ ì¶”ì¶œ ë° ê°€ê³µ
 * @param {Object} dayForecast - íŠ¹ì • ì¼ìì˜ ë‚ ì”¨ ì˜ˆì¸¡ ë°ì´í„°
 * @param {string} date - ë‚ ì§œ (YYYYMMDD í˜•ì‹)
 * @returns {Object} ê°€ê³µëœ ì¼ë³„ ë‚ ì”¨ ë°ì´í„°
 */
function extractCompleteWeatherData(dayForecast, date) {
    const times = dayForecast.times;
    const dailyData = dayForecast.dailyData;

    // ëŒ€í‘œ ì‹œê°„ ì„ íƒ (14ì‹œ ìš°ì„ , ì—†ìœ¼ë©´ 12-15ì‹œ ì‚¬ì´, ê·¸ ë‹¤ìŒ ê°€ì¥ ê°€ê¹Œìš´ ì‹œê°„)
    const timeKeys = Object.keys(times).sort();
    let representativeTime = timeKeys.find(t => t === '1400') ||
        timeKeys.find(t => t >= '1200' && t <= '1500') ||
        timeKeys[Math.floor(timeKeys.length / 2)];

    if (!representativeTime && timeKeys.length > 0) {
        representativeTime = timeKeys[0];
    }

    const data = representativeTime ? times[representativeTime] : {};

    // ì™„ì „í•œ ë‚ ì”¨ ì •ë³´ ìƒì„±
    return {
        date: date,
        dateFormatted: `${date.slice(0, 4)}-${date.slice(4, 6)}-${date.slice(6, 8)}`,
        representativeTime: representativeTime,

        // ê¸°ì˜¨ ì •ë³´ (ì™„ì „)
        temperature: data.TMP ? Math.round(parseFloat(data.TMP)) : null,
        temperatureMin: dailyData.temperatureMin ? Math.round(dailyData.temperatureMin) : null,
        temperatureMax: dailyData.temperatureMax ? Math.round(dailyData.temperatureMax) : null,
        temperatureUnit: 'Â°C',
        temperatureDescription: getTemperatureDescription(data.TMP),

        // í•˜ëŠ˜ ìƒíƒœ (ì™„ì „)
        sky: getSkyDescription(data.SKY),
        skyCode: data.SKY,
        skyDescription: WEATHER_CODES.SKY[data.SKY] || 'ì •ë³´ì—†ìŒ',

        // ê°•ìˆ˜ ì •ë³´ (ì™„ì „)
        precipitation: getPrecipitationDescription(data.PTY),
        precipitationCode: data.PTY,
        precipitationDescription: WEATHER_CODES.PTY[data.PTY] || 'ì—†ìŒ',
        precipitationProbability: data.POP ? parseInt(data.POP) : 0,
        precipitationProbabilityMax: Math.round(dailyData.precipitationProbabilityMax),
        precipitationProbabilityDescription: WEATHER_CODES.POP[data.POP] || '0% (ê°•ìˆ˜ ì—†ìŒ)',
        precipitationAmount: processPrecipitationAmount(data.PCP),
        precipitationAmountDescription: WEATHER_CODES.PCP[data.PCP] || '0mm',

        // ì ì„¤ ì •ë³´ (ì™„ì „)
        snowAmount: processSnowAmount(data.SNO),
        snowAmountDescription: WEATHER_CODES.SNO[data.SNO] || '0cm',

        // ìŠµë„ ì •ë³´ (ì™„ì „)
        humidity: data.REH ? parseInt(data.REH) : null,
        humidityUnit: '%',
        humidityDescription: getHumidityDescription(data.REH),

        // í’ì†/í’í–¥ ì •ë³´ (ì™„ì „)
        windSpeed: data.WSD ? parseFloat(data.WSD).toFixed(1) : null,
        windSpeedUnit: 'm/s',
        windSpeedDescription: getWindSpeedDescription(data.WSD),
        windDirection: getWindDirectionFromDegree(data.VEC),
        windDirectionDegree: data.VEC ? parseFloat(data.VEC) : null,
        windDirectionDescription: data.VEC ? `${getWindDirectionFromDegree(data.VEC)} (${data.VEC}Â°)` : 'ì •ë³´ì—†ìŒ',

        // íŒŒê³  ì •ë³´ (ì™„ì „)
        waveHeight: data.WAV || null,
        waveHeightDescription: WEATHER_CODES.WAV[data.WAV] || 'ì •ë³´ì—†ìŒ',

        // ì¶”ê°€ ìƒì„¸ ì •ë³´
        uvIndex: data.UVI || null, // ìì™¸ì„ ì§€ìˆ˜ (ìˆëŠ” ê²½ìš°)
        visibility: data.VIS || null, // ê°€ì‹œê±°ë¦¬ (ìˆëŠ” ê²½ìš°)

        // ì¢…í•© ë‚ ì”¨ ìƒíƒœ
        weatherStatus: getOverallWeatherStatus(data),
        weatherAdvice: getWeatherAdvice(data),

        // ì‹œê°„ë³„ ìƒì„¸ ë°ì´í„° (ì„ íƒì ìœ¼ë¡œ í¬í•¨)
        hourlyData: Object.keys(times).map(time => ({
            time: time,
            timeFormatted: `${time.slice(0, 2)}:${time.slice(2, 4)}`,
            temperature: times[time].TMP ? Math.round(parseFloat(times[time].TMP)) : null,
            sky: WEATHER_CODES.SKY[times[time].SKY] || 'ì •ë³´ì—†ìŒ',
            precipitation: WEATHER_CODES.PTY[times[time].PTY] || 'ì—†ìŒ',
            precipitationProbability: times[time].POP ? parseInt(times[time].POP) : 0,
            humidity: times[time].REH ? parseInt(times[time].REH) : null,
            windSpeed: times[time].WSD ? parseFloat(times[time].WSD).toFixed(1) : null
        })).sort((a, b) => a.time.localeCompare(b.time))
    };
}

// **ê¸°ì˜¨ì— ë”°ë¥¸ ì„¤ëª… ë°˜í™˜**
function getTemperatureDescription(temp) {
    if (!temp) return 'ì •ë³´ì—†ìŒ';
    const t = parseFloat(temp);
    if (t <= -20) return 'í˜¹í•œ (ë§¤ìš° ì¶”ì›€)';
    if (t <= -10) return 'í•œíŒŒ (ë§¤ìš° ì¶”ì›€)';
    if (t <= 0) return 'ì¶”ìœ„ (ì¶”ì›€)';
    if (t <= 9) return 'ìŒ€ìŒ€ (ìŒ€ìŒ€í•¨)';
    if (t <= 15) return 'ì„œëŠ˜ (ì„œëŠ˜í•¨)';
    if (t <= 20) return 'ì„ ì„  (ì„ ì„ í•¨)';
    if (t <= 25) return 'ì ë‹¹ (ì¾Œì í•¨)';
    if (t <= 28) return 'ë”°ëœ» (ë”°ëœ»í•¨)';
    if (t <= 32) return 'ë”ìœ„ (ë”ì›€)';
    if (t <= 35) return 'í­ì—¼ (ë§¤ìš° ë”ì›€)';
    return 'ê·¹ì‹¬í•œí­ì—¼ (ìœ„í—˜)';
}

// **í•˜ëŠ˜ ìƒíƒœ ì½”ë“œì— ë”°ë¥¸ ì„¤ëª… ë°˜í™˜**
function getSkyDescription(code) {
    return WEATHER_CODES.SKY[code] || 'ì •ë³´ì—†ìŒ';
}

// **ê°•ìˆ˜ í˜•íƒœ ì½”ë“œì— ë”°ë¥¸ ì„¤ëª… ë°˜í™˜**
function getPrecipitationDescription(code) {
    return WEATHER_CODES.PTY[code] || 'ì—†ìŒ';
}

// **ê°•ìˆ˜ëŸ‰ ê°’ ì²˜ë¦¬ ë° ì„¤ëª… ë°˜í™˜**
function processPrecipitationAmount(pcp) {
    if (!pcp || pcp === 'ê°•ìˆ˜ì—†ìŒ' || pcp === '0') return '0mm';
    if (pcp === '1mm ë¯¸ë§Œ') return '1mm ë¯¸ë§Œ';
    if (pcp.includes('mm')) return pcp;
    return `${pcp}mm`;
}

// **ì ì„¤ëŸ‰ ê°’ ì²˜ë¦¬ ë° ì„¤ëª… ë°˜í™˜**
function processSnowAmount(sno) {
    if (!sno || sno === 'ì ì„¤ì—†ìŒ' || sno === '0') return '0cm';
    if (sno === '1cm ë¯¸ë§Œ') return '1cm ë¯¸ë§Œ';
    if (sno.includes('cm')) return sno;
    return `${sno}cm`;
}

// **ìŠµë„ì— ë”°ë¥¸ ì„¤ëª… ë°˜í™˜**
function getHumidityDescription(humidity) {
    if (!humidity) return 'ì •ë³´ì—†ìŒ';
    const h = parseInt(humidity);
    if (h <= 20) return 'ë§¤ìš° ê±´ì¡°';
    if (h <= 40) return 'ê±´ì¡°';
    if (h <= 60) return 'ë³´í†µ';
    if (h <= 80) return 'ìŠµí•¨';
    return 'ë§¤ìš° ìŠµí•¨';
}

// **í’ì†ì— ë”°ë¥¸ ì„¤ëª… ë°˜í™˜**
function getWindSpeedDescription(windSpeed) {
    if (!windSpeed) return 'ì •ë³´ì—†ìŒ';
    const ws = parseFloat(windSpeed);
    if (ws < 1) return '0-1m/s (ê³ ìš”)';
    if (ws < 2) return '1-2m/s (ì‹¤ë°”ëŒ)';
    if (ws < 3) return '2-3m/s (ë‚¨ì‹¤ë°”ëŒ)';
    if (ws < 4) return '3-4m/s (ì‚°ë“¤ë°”ëŒ)';
    if (ws < 5) return '4-5m/s (ê±´ë“¤ë°”ëŒ)';
    if (ws < 7) return '5-7m/s (ì„ ì„ í•œë°”ëŒ)';
    if (ws < 9) return '7-9m/s (ì‹œì›í•œë°”ëŒ)';
    if (ws < 11) return '9-11m/s (ì„¼ë°”ëŒ)';
    if (ws < 14) return '11-14m/s (ê°•í•œë°”ëŒ)';
    if (ws < 17) return '14-17m/s (ë§¤ìš°ê°•í•œë°”ëŒ)';
    if (ws < 21) return '17-21m/s (í­í’)';
    if (ws < 25) return '21-25m/s (ê°•í•œí­í’)';
    return '25m/s ì´ìƒ (ë§¤ìš°ê°•í•œí­í’)';
}

// **í’í–¥ ê°ë„ì— ë”°ë¥¸ 16ë°©ìœ„ ì„¤ëª… ë°˜í™˜**
function getWindDirectionFromDegree(degree) {
    if (!degree && degree !== 0) return 'ì •ë³´ì—†ìŒ';

    const deg = parseFloat(degree);
    const normalizedDeg = ((deg % 360) + 360) % 360;

    const directions = [
        'ë¶', 'ë¶ë¶ë™', 'ë¶ë™', 'ë™ë¶ë™', 'ë™', 'ë™ë‚¨ë™', 'ë‚¨ë™', 'ë‚¨ë‚¨ë™',
        'ë‚¨', 'ë‚¨ë‚¨ì„œ', 'ë‚¨ì„œ', 'ì„œë‚¨ì„œ', 'ì„œ', 'ì„œë¶ì„œ', 'ë¶ì„œ', 'ë¶ë¶ì„œ'
    ];

    const index = Math.round(normalizedDeg / 22.5) % 16;
    return directions[index];
}

// **ì£¼ìš” ë‚ ì”¨ ìš”ì†Œ ê¸°ë°˜ ì¢…í•© ë‚ ì”¨ ìƒíƒœ ë°˜í™˜**
function getOverallWeatherStatus(data) {
    const temp = data.TMP ? parseFloat(data.TMP) : null;
    const sky = data.SKY;
    const pty = data.PTY;
    const pop = data.POP ? parseInt(data.POP) : 0;

    if (pty && pty !== '0') {
        const precipType = WEATHER_CODES.PTY[pty] || 'ê°•ìˆ˜';
        if (pop >= 80) return `${precipType} í™•ì‹¤`;
        if (pop >= 60) return `${precipType} ê°€ëŠ¥ì„± ë†’ìŒ`;
        return `${precipType} ê°€ëŠ¥ì„± ìˆìŒ`;
    }

    if (pop >= 60) {
        return 'ê°•ìˆ˜ ê°€ëŠ¥ì„± ë†’ìŒ';
    }

    const skyDesc = WEATHER_CODES.SKY[sky] || 'ì •ë³´ì—†ìŒ';

    if (temp !== null) {
        if (temp >= 33) return `${skyDesc}, í­ì—¼ ì£¼ì˜`;
        if (temp >= 28) return `${skyDesc}, ë”ì›€`;
        if (temp >= 21) return `${skyDesc}, ì¾Œì `;
        if (temp >= 10) return `${skyDesc}, ì„ ì„ `;
        if (temp >= 0) return `${skyDesc}, ìŒ€ìŒ€`;
        return `${skyDesc}, ì¶”ì›€`;
    }

    return skyDesc;
}

// **í˜„ì¬ ë‚ ì”¨ ë°ì´í„° ê¸°ë°˜ ë§ì¶¤í˜• ì¡°ì–¸ ë°˜í™˜**
function getWeatherAdvice(data) {
    const temp = data.TMP ? parseFloat(data.TMP) : null;
    const pty = data.PTY;
    const pop = data.POP ? parseInt(data.POP) : 0;
    const wsd = data.WSD ? parseFloat(data.WSD) : 0;

    const advice = [];

    // ê¸°ì˜¨ ê´€ë ¨ ì¡°ì–¸
    if (temp !== null) {
        if (temp >= 35) advice.push('ğŸŒ¡ï¸ í­ì—¼ ê²½ë³´! ì•¼ì™¸í™œë™ ìì œí•˜ì„¸ìš”');
        else if (temp >= 33) advice.push('ğŸŒ¡ï¸ í­ì—¼ ì£¼ì˜! ì¶©ë¶„í•œ ìˆ˜ë¶„ ì„­ì·¨í•˜ì„¸ìš”');
        else if (temp >= 28) advice.push('â˜€ï¸ ë”ìš´ ë‚ ì”¨, ì‹œì›í•œ ë³µì¥ ì¶”ì²œ');
        else if (temp <= -10) advice.push('ğŸ§Š í•œíŒŒ ì£¼ì˜! ë°©í•œìš©í’ˆ í•„ìˆ˜');
        else if (temp <= 0) advice.push('â„ï¸ ì¶”ìš´ ë‚ ì”¨, ë”°ëœ»í•œ ë³µì¥ í•„ìš”');
        else if (temp <= 10) advice.push('ğŸ§¥ ìŒ€ìŒ€í•œ ë‚ ì”¨, ì™¸íˆ¬ ì¤€ë¹„í•˜ì„¸ìš”');
    }

    // ê°•ìˆ˜ ê´€ë ¨ ì¡°ì–¸
    if (pty && pty !== '0') {
        const precipType = WEATHER_CODES.PTY[pty];
        if (precipType.includes('ë¹„')) advice.push('â˜” ìš°ì‚° ë˜ëŠ” ìš°ë¹„ ì¤€ë¹„í•˜ì„¸ìš”');
        if (precipType.includes('ëˆˆ')) advice.push('â›„ ëˆˆ ì˜ˆë³´, ë¯¸ë„ëŸ¼ ì£¼ì˜í•˜ì„¸ìš”');
        if (precipType.includes('í­ìš°')) advice.push('ğŸŒŠ í­ìš° ì£¼ì˜! ì €ì§€ëŒ€ ì¹¨ìˆ˜ ì¡°ì‹¬');
    } else if (pop >= 60) {
        advice.push('ğŸŒ§ï¸ ê°•ìˆ˜ ê°€ëŠ¥ì„± ë†’ìŒ, ìš°ì‚° ì¤€ë¹„ ê¶Œì¥');
    } else if (pop >= 30) {
        advice.push('â˜ï¸ êµ¬ë¦„ ë§ìŒ, ìš°ì‚° íœ´ëŒ€ ê¶Œì¥');
    }

    // ë°”ëŒ ê´€ë ¨ ì¡°ì–¸
    if (wsd >= 14) advice.push('ğŸ’¨ ê°•í’ ì£¼ì˜! ì•¼ì™¸í™œë™ ì¡°ì‹¬í•˜ì„¸ìš”');
    else if (wsd >= 10) advice.push('ğŸŒ¬ï¸ ë°”ëŒì´ ê°•í•´ìš”, ëª¨ìë‚˜ ê°€ë²¼ìš´ ë¬¼ê±´ ì£¼ì˜');

    return advice.length > 0 ? advice.join(' | ') : 'ì¾Œì í•œ ë‚ ì”¨ì…ë‹ˆë‹¤';
}

/**
 * API í‚¤ê°€ ì—†ê±°ë‚˜ ì˜¤ë¥˜ ë°œìƒ ì‹œ ì™„ì „í•œ ìƒ˜í”Œ ë°ì´í„° ìƒì„±
 * @param {string} region - ìš”ì²­ëœ ì§€ì—­ëª…
 * @param {string} [errorMessage=null] - ë°œìƒí•œ ì˜¤ë¥˜ ë©”ì‹œì§€ (ì„ íƒ ì‚¬í•­)
 * @returns {Array} ìƒ˜í”Œ ë‚ ì”¨ ë°ì´í„° ë°°ì—´
 */
function generateCompleteSampleData(region, errorMessage = null) {
    const today = new Date();
    const kst = new Date(today.getTime() + 9 * 60 * 60 * 1000);

    const dates = [];
    for (let i = 0; i < 3; i++) {
        const date = new Date(kst.getTime() + i * 24 * 60 * 60 * 1000);
        dates.push(date);
    }

    const baseMessage = errorMessage ? `âš ï¸ ì˜¤ë¥˜: ${errorMessage}` : 'âš ï¸ WEATHER_API_KEY ì„¤ì • í•„ìš” - ìƒ˜í”Œ ë°ì´í„°';
    const sampleTemps = [20, 22, 21];
    const sampleSkies = ['1', '3', '4'];
    const samplePrecips = ['0', '0', '1'];

    // ìƒ˜í”Œ ë°ì´í„°ì˜ locationInfoì— ëŒ€í•œ fullNameì„ 'ì„œìš¸íŠ¹ë³„ì‹œ'ë¡œ ì„¤ì •
    const defaultLocationFullName = 'ì„œìš¸íŠ¹ë³„ì‹œ';

    return dates.map((date, index) => ({
        date: date.toISOString().slice(0, 10).replace(/-/g, ''),
        dateFormatted: date.toISOString().slice(0, 10),
        dayLabel: index === 0 ? 'ì˜¤ëŠ˜' : index === 1 ? 'ë‚´ì¼' : 'ëª¨ë ˆ',
        dayIndex: index,
        representativeTime: '1400',

        // ê¸°ì˜¨ ì •ë³´
        temperature: errorMessage ? null : sampleTemps[index],
        temperatureMin: errorMessage ? null : sampleTemps[index] - 5,
        temperatureMax: errorMessage ? null : sampleTemps[index] + 5,
        temperatureUnit: 'Â°C',
        temperatureDescription: errorMessage ? 'ì •ë³´ì—†ìŒ' : getTemperatureDescription(sampleTemps[index]),

        // í•˜ëŠ˜ ìƒíƒœ
        sky: errorMessage ? 'ì •ë³´ì—†ìŒ' : WEATHER_CODES.SKY[sampleSkies[index]],
        skyCode: errorMessage ? null : sampleSkies[index],
        skyDescription: errorMessage ? 'ì •ë³´ì—†ìŒ' : WEATHER_CODES.SKY[sampleSkies[index]],

        // ê°•ìˆ˜ ì •ë³´
        precipitation: errorMessage ? 'ì •ë³´ì—†ìŒ' : WEATHER_CODES.PTY[samplePrecips[index]],
        precipitationCode: errorMessage ? null : samplePrecips[index],
        precipitationDescription: errorMessage ? 'ì •ë³´ì—†ìŒ' : WEATHER_CODES.PTY[samplePrecips[index]],
        precipitationProbability: errorMessage ? null : [10, 30, 60][index],
        precipitationProbabilityMax: errorMessage ? null : [10, 30, 60][index],
        precipitationProbabilityDescription: errorMessage ? 'ì •ë³´ì—†ìŒ' : WEATHER_CODES.POP[[10, 30, 60][index]],
        precipitationAmount: errorMessage ? 'ì •ë³´ì—†ìŒ' : index === 2 ? '5mm' : '0mm',
        precipitationAmountDescription: errorMessage ? 'ì •ë³´ì—†ìŒ' : index === 2 ? '5mm (ë³´í†µ ë¹„)' : '0mm',

        // ì ì„¤ ì •ë³´
        snowAmount: '0cm',
        snowAmountDescription: '0cm',

        // ìŠµë„ ì •ë³´
        humidity: errorMessage ? null : [60, 70, 80][index],
        humidityUnit: '%',
        humidityDescription: errorMessage ? 'ì •ë³´ì—†ìŒ' : getHumidityDescription([60, 70, 80][index]),

        // í’ì†/í’í–¥ ì •ë³´
        windSpeed: errorMessage ? null : [2.5, 3.0, 3.5][index].toFixed(1),
        windSpeedUnit: 'm/s',
        windSpeedDescription: errorMessage ? 'ì •ë³´ì—†ìŒ' : getWindSpeedDescription([2.5, 3.0, 3.5][index]),
        windDirection: errorMessage ? 'ì •ë³´ì—†ìŒ' : ['ë¶ë™', 'ë‚¨', 'ì„œ'][index],
        windDirectionDegree: errorMessage ? null : [45, 180, 270][index],
        windDirectionDescription: errorMessage ? 'ì •ë³´ì—†ìŒ' : `${['ë¶ë™', 'ë‚¨', 'ì„œ'][index]} (${[45, 180, 270][index]}Â°)`,

        // íŒŒê³  ì •ë³´
        waveHeight: null,
        waveHeightDescription: 'ì •ë³´ì—†ìŒ',

        // ì¶”ê°€ ì •ë³´
        uvIndex: null,
        visibility: null,

        // ì¢…í•© ìƒíƒœ
        weatherStatus: errorMessage ? 'ì •ë³´ì—†ìŒ' : getOverallWeatherStatus({
            TMP: sampleTemps[index],
            SKY: sampleSkies[index],
            PTY: samplePrecips[index],
            POP: [10, 30, 60][index]
        }),
        weatherAdvice: errorMessage ? 'ì •ë³´ë¥¼ í™•ì¸í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤' : getWeatherAdvice({
            TMP: sampleTemps[index],
            PTY: samplePrecips[index],
            POP: [10, 30, 60][index],
            WSD: [2.5, 3.0, 3.5][index]
        }),

        // ì‹œê°„ë³„ ë°ì´í„° (ìƒ˜í”Œ)
        hourlyData: errorMessage ? [] : [
            {
                time: '0600',
                timeFormatted: '06:00',
                temperature: sampleTemps[index] - 3,
                sky: WEATHER_CODES.SKY[sampleSkies[index]],
                precipitation: WEATHER_CODES.PTY[samplePrecips[index]],
                precipitationProbability: [10, 30, 60][index],
                humidity: [60, 70, 80][index],
                windSpeed: [2.5, 3.0, 3.5][index].toFixed(1)
            },
            {
                time: '1200',
                timeFormatted: '12:00',
                temperature: sampleTemps[index],
                sky: WEATHER_CODES.SKY[sampleSkies[index]],
                precipitation: WEATHER_CODES.PTY[samplePrecips[index]],
                precipitationProbability: [10, 30, 60][index],
                humidity: [60, 70, 80][index],
                windSpeed: [2.5, 3.0, 3.5][index].toFixed(1)
            },
            {
                time: '1800',
                timeFormatted: '18:00',
                temperature: sampleTemps[index] - 2,
                sky: WEATHER_CODES.SKY[sampleSkies[index]],
                precipitation: WEATHER_CODES.PTY[samplePrecips[index]],
                precipitationProbability: [10, 30, 60][index],
                humidity: [60, 70, 80][index],
                windSpeed: [2.5, 3.0, 3.5][index].toFixed(1)
            }
        ],

        message: `${baseMessage} (${['ì˜¤ëŠ˜', 'ë‚´ì¼', 'ëª¨ë ˆ'][index]})`,
        timestamp: new Date().toISOString(),
        region: region
    }));
}

/**
 * ë©”ì¸ ì„œë²„ë¦¬ìŠ¤ í•¸ë“¤ëŸ¬ í•¨ìˆ˜
 * @param {Object} req - ìš”ì²­ ê°ì²´
 * @param {Object} res - ì‘ë‹µ ê°ì²´
 */
module.exports = async function handler(req, res) {
    // CORS ì„¤ì •
    res.setHeader('Access-Control-Allow-Origin', '*');
    res.setHeader('Access-Control-Allow-Methods', 'GET, OPTIONS');
    res.setHeader('Access-Control-Allow-Headers', 'Content-Type');
    res.setHeader('Cache-Control', 's-maxage=1800, stale-while-revalidate=3600');

    if (req.method === 'OPTIONS') {
        return res.status(200).end();
    }

    if (req.method !== 'GET') {
        return res.status(405).json({
            success: false,
            error: 'Method not allowed',
            message: 'GET ìš”ì²­ë§Œ ì§€ì›ë©ë‹ˆë‹¤.'
        });
    }

    try {
        // ê¸°ë³¸ ì§€ì—­ì„ 'ì„œìš¸'ë¡œ ì„¤ì • (ì „êµ­ ê´€ê´‘ ëª©ì )
        const { region = DEFAULT_REGION, lat, lon, detailed = 'true' } = req.query;
        const weatherApiKey = process.env.WEATHER_API_KEY;

        console.log('ì™„ì „í•œ ë‚ ì”¨ API ìš”ì²­:', {
            region,
            lat,
            lon,
            detailed,
            hasWeatherApiKey: !!weatherApiKey,
            timestamp: new Date().toISOString()
        });

        // API í‚¤ í™•ì¸ ë° ìƒ˜í”Œ ë°ì´í„° ì œê³µ ë¡œì§ (ê¸°ì¡´ ìœ ì§€)
        if (!weatherApiKey) {
            console.warn('âš ï¸ WEATHER_API_KEY í™˜ê²½ ë³€ìˆ˜ê°€ ì„¤ì •ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.');
            // ìƒ˜í”Œ ë°ì´í„°ì˜ locationInfo.fullNameë„ 'ì„œìš¸íŠ¹ë³„ì‹œ'ë¡œ ì¼ê´€ì„± ìˆê²Œ ë³€ê²½
            return res.status(200).json({
                success: true,
                data: generateCompleteSampleData(region),
                warning: 'WEATHER_API_KEYê°€ ì„¤ì •ë˜ì§€ ì•Šì•„ ìƒ˜í”Œ ë°ì´í„°ë¥¼ ì œê³µí•©ë‹ˆë‹¤.',
                environment: 'development',
                apiInfo: {
                    source: 'ìƒ˜í”Œ ë°ì´í„°',
                    timestamp: new Date().toISOString(),
                    region: region
                },
                locationInfo: { // ì˜¤ë¥˜ ì‹œ ë°˜í™˜ë˜ëŠ” ìµœìƒìœ„ locationInfoë„ 'ì„œìš¸íŠ¹ë³„ì‹œ'ë¡œ ë³€ê²½
                    requested: region,
                    matched: 'ìƒ˜í”Œ ë°ì´í„°ìš© ê¸°ë³¸ê°’',
                    fullName: 'ì„œìš¸íŠ¹ë³„ì‹œ',
                    source: 'ìƒ˜í”Œ ë°ì´í„°'
                }
            });
        }

        let coordinates;
        let locationInfo;

        // ìœ„ê²½ë„ê°€ ì§ì ‘ ì œê³µëœ ê²½ìš°
        if (lat && lon) {
            const latitude = parseFloat(lat);
            const longitude = parseFloat(lon);

            if (isNaN(latitude) || isNaN(longitude)) {
                throw new Error('ì˜ëª»ëœ ìœ„ê²½ë„ í˜•ì‹ì…ë‹ˆë‹¤.');
            }

            coordinates = latLonToGrid(latitude, longitude);
            locationInfo = {
                requested: `${lat}, ${lon}`,
                matched: `ìœ„ê²½ë„ (${lat}, ${lon})`,
                fullName: `ìœ„ë„ ${lat}, ê²½ë„ ${lon}`,
                coordinates: coordinates,
                source: 'ì§ì ‘ ì¢Œí‘œ'
            };

            console.log('ìœ„ê²½ë„ ë³€í™˜ ì™„ë£Œ:', { lat, lon, grid: coordinates });
        } else {
            // ì§€ì—­ëª…ìœ¼ë¡œ ê²€ìƒ‰
            const location = findLocationCoordinates(region);
            coordinates = latLonToGrid(location.lat, location.lon);
            locationInfo = {
                requested: region,
                matched: location.name,
                fullName: location.name,
                coordinates: coordinates,
                latLon: { lat: location.lat, lon: location.lon },
                source: 'ì§€ì—­ëª… ê²€ìƒ‰'
            };

            console.log('ì§€ì—­ëª… ê²€ìƒ‰ ì™„ë£Œ:', { region, location: location.name, grid: coordinates });
        }

        // í•œêµ­ í‘œì¤€ì‹œ(KST) ê¸°ì¤€ ì‹œê°„ ê³„ì‚°
        const now = new Date();
        const kst = new Date(now.getTime() + 9 * 60 * 60 * 1000);

        // ê¸°ìƒì²­ API ë°œí‘œ ì‹œê° ê³„ì‚°
        let baseTime = '';
        const hour = kst.getHours();
        if (hour >= 23 || hour < 2) baseTime = '2300';
        else if (hour < 5) baseTime = '0200';
        else if (hour < 8) baseTime = '0500';
        else if (hour < 11) baseTime = '0800';
        else if (hour < 14) baseTime = '1100';
        else if (hour < 17) baseTime = '1400';
        else if (hour < 20) baseTime = '1700';
        else baseTime = '2000';

        let baseDate = kst.toISOString().slice(0, 10).replace(/-/g, '');

        // ìì • ì „í›„ ì‹œê°„ ì²˜ë¦¬
        if (hour < 2 && baseTime === '2300') {
            const yesterday = new Date(kst.getTime() - 24 * 60 * 60 * 1000);
            baseDate = yesterday.toISOString().slice(0, 10).replace(/-/g, '');
        }

        // ìºì‹œ í™•ì¸
        const cacheKey = `complete_${coordinates.nx}_${coordinates.ny}_${baseDate}_${baseTime}`;
        const cachedData = weatherCache.get(cacheKey);

        if (cachedData && Date.now() - cachedData.timestamp < 30 * 60 * 1000) {
            console.log('âœ… ìºì‹œëœ ë°ì´í„° ì‚¬ìš©:', cacheKey);

            // ì§€ì—­ ì •ë³´ ì—…ë°ì´íŠ¸
            const responseData = { ...cachedData.data };
            responseData.locationInfo = locationInfo; // í˜„ì¬ ìš”ì²­ì— ë§ëŠ” locationInfoë¡œ ë®ì–´ì“°ê¸°

            return res.status(200).json(responseData);
        }

        console.log('ğŸŒ¤ï¸ ê¸°ìƒì²­ API í˜¸ì¶œ ì‹œì‘:', {
            baseDate,
            baseTime,
            nx: coordinates.nx,
            ny: coordinates.ny,
            location: locationInfo.fullName
        });

        // ê¸°ìƒì²­ API í˜¸ì¶œ
        const response = await axios.get('http://apis.data.go.kr/1360000/VilageFcstInfoService_2.0/getVilageFcst', {
            params: {
                serviceKey: weatherApiKey,
                numOfRows: 300,
                pageNo: 1,
                dataType: 'JSON',
                base_date: baseDate,
                base_time: baseTime,
                nx: coordinates.nx,
                ny: coordinates.ny
            },
            timeout: 10000,
            headers: {
                'User-Agent': 'HealingK-Complete-Weather-Service/2.0'
            }
        });

        // API ì‘ë‹µ ê²€ì¦
        if (!response.data?.response?.body?.items?.item) {
            throw new Error('ê¸°ìƒì²­ API ì‘ë‹µì— ë‚ ì”¨ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.');
        }

        const resultCode = response.data.response.header.resultCode;
        if (resultCode !== '00') {
            const errorMsg = ERROR_MESSAGES[resultCode] || `ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜ (ì½”ë“œ: ${resultCode})`;
            throw new Error(`ê¸°ìƒì²­ API ì˜¤ë¥˜: ${errorMsg}`);
        }

        const items = response.data.response.body.items.item || [];
        console.log('ğŸ“Š ë°›ì€ ê¸°ìƒ ë°ì´í„° í•­ëª© ìˆ˜:', items.length);

        // ì™„ì „í•œ ë‚ ì”¨ ë°ì´í„° ì²˜ë¦¬
        const weatherData = processCompleteWeatherData(items, kst);

        console.log('âœ… ì™„ì „í•œ ë‚ ì”¨ ë°ì´í„° ì²˜ë¦¬ ì™„ë£Œ:', weatherData.length, 'ì¼');

        // ìµœì¢… ì‘ë‹µ ë°ì´í„° êµ¬ì„±
        const responseData = {
            success: true,
            data: weatherData,
            locationInfo: locationInfo,
            apiInfo: {
                source: 'ê¸°ìƒì²­ ë‹¨ê¸°ì˜ˆë³´ API',
                baseDate: baseDate,
                baseTime: baseTime,
                timestamp: new Date().toISOString(),
                apiKeyUsed: 'WEATHER_API_KEY',
                totalCategories: Object.keys(WEATHER_CODES).length,
                dataPoints: items.length,
                version: '2.0-complete'
            },
            weatherCodes: detailed === 'true' ? WEATHER_CODES : undefined
        };

        // ìºì‹œ ì €ì¥
        weatherCache.set(cacheKey, {
            data: responseData,
            timestamp: Date.now()
        });

        // ìºì‹œ í¬ê¸° ê´€ë¦¬ (ìµœëŒ€ 100ê°œ í•­ëª©)
        if (weatherCache.size > 100) {
            const oldestKey = weatherCache.keys().next().value;
            weatherCache.delete(oldestKey);
            console.log('ğŸ§¹ ìºì‹œ ì •ë¦¬ ì™„ë£Œ. í˜„ì¬ ìºì‹œ í¬ê¸°:', weatherCache.size);
        }

        console.log('ğŸ‰ ì™„ì „í•œ ë‚ ì”¨ API ì‘ë‹µ ì„±ê³µ');
        return res.status(200).json(responseData);

    } catch (error) {
        console.error('âŒ ì™„ì „í•œ ë‚ ì”¨ API ì˜¤ë¥˜:', {
            message: error.message,
            code: error.code,
            response: error.response?.data,
            stack: process.env.NODE_ENV === 'development' ? error.stack : undefined
        });

        // ì—ëŸ¬ íƒ€ì…ë³„ ìƒì„¸ ë¡œê¹…
        if (error.code === 'ECONNABORTED') {
            console.error('â° API ìš”ì²­ íƒ€ì„ì•„ì›ƒ ë°œìƒ');
        } else if (error.response) {
            console.error('ğŸš« API ì‘ë‹µ ì˜¤ë¥˜:', {
                status: error.response.status,
                statusText: error.response.statusText,
                data: error.response.data
            });
        } else if (error.request) {
            console.error('ğŸŒ ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜ - ì‘ë‹µ ì—†ìŒ');
        }

        // ì—ëŸ¬ ë°œìƒ ì‹œì—ë„ ì™„ì „í•œ ìƒ˜í”Œ ë°ì´í„° ë°˜í™˜
        return res.status(200).json({
            success: false,
            error: true,
            errorMessage: error.message,
            data: generateCompleteSampleData(req.query.region || DEFAULT_REGION, error.message),
            locationInfo: { // ì˜¤ë¥˜ ì‹œ ë°˜í™˜ë˜ëŠ” ìµœìƒìœ„ locationInfoë„ 'ì„œìš¸íŠ¹ë³„ì‹œ'ë¡œ ë³€ê²½
                requested: req.query.region || DEFAULT_REGION,
                matched: 'ì˜¤ë¥˜ë¡œ ì¸í•œ ê¸°ë³¸ê°’',
                fullName: 'ì„œìš¸íŠ¹ë³„ì‹œ',
                source: 'ì˜¤ë¥˜ ì²˜ë¦¬'
            },
            apiInfo: {
                source: 'ì˜¤ë¥˜ ì‹œ ìƒ˜í”Œ ë°ì´í„°',
                timestamp: new Date().toISOString(),
                environment: process.env.NODE_ENV || 'production',
                version: '2.0-complete-error',
                errorHandled: true
            },
            warning: 'ì‹¤ì‹œê°„ ë‚ ì”¨ ì •ë³´ë¥¼ ê°€ì ¸ì˜¬ ìˆ˜ ì—†ì–´ ìƒ˜í”Œ ë°ì´í„°ë¥¼ ì œê³µí•©ë‹ˆë‹¤.'
        });
    }
};
